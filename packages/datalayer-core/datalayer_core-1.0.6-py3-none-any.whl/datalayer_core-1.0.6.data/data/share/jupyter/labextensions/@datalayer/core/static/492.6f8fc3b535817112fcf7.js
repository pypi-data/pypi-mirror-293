"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[492],{40492:(e,t,n)=>{n.r(t),n.d(t,{ExerciseNew:()=>m,default:()=>g});var r=n(74512),o=n(66029),s=n(71082),i=n(23189),a=n(75291),l=n(54977),c=n(41877),d=n.n(c);function h(e){const t=d()(e);if(0===t)return e;const n=new RegExp(`^[ \\t]{${t}}`,"gm");return e.replace(n,"")}var u=n(68335),p=n(43712),x=n(42799);const m=()=>{const e=(0,p.aF)(),t=(0,x.qX)(),n=(0,x.Ae)(),c=(0,a.useOutputsStore)(),d=(0,p.s0)(),{enqueueToast:m}=(0,p.pm)(),{kernelManager:g,defaultKernel:j}=(0,a.useJupyter)(),C=t.layout().leftSidebarVariant,b=t.layout().organization,v=t.layout().space,f=(0,o.useMemo)((()=>j),[g]),{getSpaceDatasets:F,refreshSpaceDatasets:y}=(0,p.YT)(),[w,T]=(0,o.useState)(F()),k=c.outputs?.get("exercise-pre")?.input,S=c.outputs?.get("exercise-solution")?.input,L=c.outputs?.get("exercise-question")?.input,_=c.outputs?.get("exercise-test")?.input,[E,D]=(0,o.useState)({name:void 0,description:void 0,help:'Use the assignment operator "=" to create the variable "x".'}),[$,q]=(0,o.useState)({name:void 0,description:void 0,help:!0});(0,o.useEffect)((()=>{v&&y(v,b).then((e=>{e.success&&T(F())}))}),[v]),(0,o.useEffect)((()=>{q({...$,name:void 0===E.name?void 0:E.name.length>2,description:void 0===E.description?void 0:E.description.length>2,help:void 0===E.help?void 0:E.help.length>2})}),[E]);const{isLoading:B,isSuccess:R,uploadAndSubmit:V,progress:z}=(0,p.Wy)(`${n.configuration.spacerRunUrl}/api/spacer/v1/exercises`);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Pagehead,{children:(0,r.jsx)(s.Heading,{sx:{fontSize:3},children:"New exercise"})}),(0,r.jsxs)(s.Box,{children:[(0,r.jsxs)(s.Box,{sx:{label:{marginTop:2},"label + span":{marginBottom:2}},children:[(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Name"}),(0,r.jsx)(s.FormControl.Caption,{children:"Name of the exercise."}),(0,r.jsx)(s.TextInput,{block:!0,value:E.name,onChange:e=>{D((t=>({...t,name:e.target.value})))}}),!1===$.name&&(0,r.jsx)(s.FormControl.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Description"}),(0,r.jsx)(s.FormControl.Caption,{children:"Description of the exercise."}),(0,r.jsx)(s.Textarea,{block:!0,value:E.description,onChange:e=>{D((t=>({...t,description:e.target.value})))}}),!1===$.description&&(0,r.jsx)(s.FormControl.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,r.jsxs)(s.Box,{display:"grid",gridTemplateColumns:"1fr 1fr",gridGap:3,children:[(0,r.jsxs)(s.Box,{children:[(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Preliminary code"}),(0,r.jsx)(s.FormControl.Caption,{children:"This is the preliminary code that will be run before the exercise is taken."})]}),(0,r.jsx)(l.r,{showEditor:!0,autoRun:!0,kernel:f,code:"# Insert your preliminary code here.",id:"exercise-pre"})]}),(0,r.jsxs)(s.Box,{children:[(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Datasets"}),(0,r.jsx)(s.FormControl.Caption,{children:"Select the datasets to be used in the prelimary code."})]}),(0,r.jsx)(s.ActionList,{showDividers:!0,role:"listbox","aria-label":"Select assignees",children:w.map((e=>(0,r.jsxs)(s.ActionList.Item,{role:"option",onClick:t=>{t.preventDefault(),c.setDataset("exercise-pre",e)},children:[(0,r.jsx)(s.ActionList.LeadingVisual,{children:(0,r.jsx)(i.VHe,{})}),e.name,(0,r.jsxs)(s.ActionList.Description,{children:[e.mimeType," ",(0,u.Aq)(e.description)]})]},e.id)))})]})]}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Solution Code"}),(0,r.jsx)(s.FormControl.Caption,{children:"This is the expected solution code. The student will never see this content."})]}),(0,r.jsx)(l.r,{showEditor:!0,autoRun:!0,kernel:f,id:"exercise-solution",code:"# Create a variable x, equals to 3.\nx = 3\n\n# Print x.\nprint(x)"}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Question code"}),(0,r.jsx)(s.FormControl.Caption,{children:"This the question code that will be shown to the student."})]}),(0,r.jsx)(l.r,{showEditor:!0,autoRun:!1,kernel:f,id:"exercise-question",code:h("# Create a variable x, equals to 3.\n...\n\n# Print x.\n...\n").trim()}),(0,r.jsx)(s.Box,{children:(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Help for the student"}),(0,r.jsx)(s.FormControl.Caption,{children:"This a help that will be shown to the student if he asks for it."}),(0,r.jsx)(s.Textarea,{block:!0,value:E.help,onChange:e=>{D((t=>({...t,help:e.target.value})))}}),!1===$.help&&(0,r.jsx)(s.FormControl.Validation,{variant:"error",children:"Help must have more than 2 characters"})]})}),(0,r.jsxs)(s.FormControl,{children:[(0,r.jsx)(s.FormControl.Label,{children:"Test the Solution code"}),(0,r.jsxs)(s.FormControl.Caption,{children:["Write the test code that will be run on the student's code during the exercise. Please refer to the ",(0,r.jsx)(s.Link,{href:"https://nbgrader.readthedocs.io/en/latest/user_guide/autograding_resources.html",target:"_blank",children:"nbgrader"})," documentation."]})]}),(0,r.jsx)(l.r,{showEditor:!0,autoRun:!1,disableRun:!0,kernel:f,id:"exercise-test",code:'Ex().check_object("x")\nEx().check_object("x").has_equal_value()\nEx().has_output("3")\nprint(\'Congratulations. You have successfully passed this exercise.\')'})]}),(0,r.jsx)(s.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:'Validate you tests with this button. It will run the "Preliminary code", then will run the "Test code" on the "Solution code". When a student will take the exercise, the "Test code" will be run on the "Student code".'}),(0,r.jsx)(s.Button,{variant:"danger",leadingVisual:i.Zi2,sx:{marginTop:2,marginBottom:2},onClick:e=>{e.preventDefault(),c.setExecuteRequest("exercise-test",`\nsetup_state(stu_code = """${k}\n${S}""", sol_code = """${k}\n${S}""")\n${_}\n`)},children:"Test"}),(0,r.jsx)(s.Text,{as:"p",color:"fg.onEmphasis",bg:"neutral.emphasis",p:2,children:"Once you are confident with your test, you can create the exercise. Don't worry, you can still update it before making it public."}),(0,r.jsx)(s.Button,{variant:"primary",disabled:B||!$.name||!$.description,sx:{marginTop:2},onClick:async()=>{const n=new FormData;n.append("name",E.name),n.append("description",E.description),n.append("help",E.help),n.append("codePre",k??""),n.append("codeSolution",S??""),n.append("codeQuestion",L??""),n.append("codeTest",_??""),n.append("accountType","organization-space"===C?"organization":"user"),n.append("accountId","organization-space"===C?b?.id:e?.id),n.append("spaceId",v?.id),V(n).then((n=>{n.success&&(m("The exercise has been created.",{variant:"success"}),"organization"===C||"organization-space"===C?(d(`/${b?.handle}/${v?.handle}/exercise/${n.exercise.uid}`),t.layout().triggerItemsRefresh()):d(`/${e?.handle}/${v?.handle}/exercises`))}))},children:"Create an exercise"})]})]})},g=m},41877:e=>{e.exports=e=>{const t=e.match(/^[ \t]*(?=\S)/gm);return t?t.reduce(((e,t)=>Math.min(e,t.length)),1/0):0}}}]);