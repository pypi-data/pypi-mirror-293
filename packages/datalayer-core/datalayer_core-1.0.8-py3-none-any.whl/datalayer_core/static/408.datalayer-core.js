"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[408],{60408:(e,o,t)=>{t.r(o),t.d(o,{NotebookEdit:()=>g,default:()=>Z});var s=t(91896),a=t(56769),n=t(59886),r=t(36705),i=t(64506),l=t(81457),c=t(31728),d=t(13676),h=t(45775),u=t(55627),p=t(91228),m=t(87822),k=t(39617),b=t(60299),x=t(96997),y=t(55060),f=t(21678),j=t(90673),v=t(45209);const g=()=>{const{notebookId:e}=(0,n.UO)();if(!e)return(0,s.jsx)(s.Fragment,{});const o=(0,j.aF)(),t=(0,r.N)(),g=(0,j.s0)(),Z=(0,v.qX)(),N=(0,b.qL)(),C=Z.layout().space,B=(0,v.D1)().saveRequest,S=N.selectNotebookModel(e),{cloneNotebook:w,getNotebook:T,refreshNotebook:I,updateNotebook:F,updateNotebookModel:L}=(0,j.YT)(),{enqueueToast:P}=(0,j.pm)(),[q,D]=(0,a.useState)("notebook"),[E,O]=(0,a.useState)(),[R,_]=(0,a.useState)({name:"",description:""}),[M,V]=(0,a.useState)({name:void 0,description:void 0}),z=(e,o)=>{o.preventDefault(),Z.layout().resetRightPortal(),"properties"===e&&J(),D(e)};(0,a.useEffect)((()=>("notebook"===q&&(Z.layout().showBackdrop(),I(e).then((o=>{if(Z.layout().hideBackdrop(),o.success){const o=T(e);o?(O(o),Z.layout().setItem(o),_({name:o.name,description:o.description})):g("/")}})).finally((()=>{Z.layout().hideBackdrop()}))),()=>{O(void 0),N.reset(),Z.layout().setItem(void 0)})),[e]);const J=()=>{S?.model?.cells&&(Z.layout().showBackdrop("Saving the notebook..."),L(e,S.model.toJSON()).then((e=>{e.success&&(P("The notebook is successfully updated.",{variant:"success"}),O({...E,nbformat:S.model.toJSON()}))})).finally((()=>{Z.layout().hideBackdrop()})))};(0,a.useEffect)((()=>{B&&E&&J()}),[B]),(0,a.useEffect)((()=>{V({...M,name:void 0===R.name?void 0:R.name.length>2,description:void 0===R.description?void 0:R.description.length>2})}),[R]);const U=(0,a.useCallback)((async s=>{t({title:"Are you sure?",content:"Please confirm you want to clone this notebook in your private library."}).then((t=>{t&&(Z.layout().showBackdrop(),w(e).then((e=>{Z.layout().hideBackdrop(),e.success&&(P(e.message,{variant:"success"}),Z.layout().triggerItemsRefresh(),g(`/${o.handle}/library/notebooks`))})))}))}),[t,E]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Z,{children:(0,s.jsxs)(l.Z,{display:"flex",children:[(0,s.jsx)(l.Z,{flex:1,children:(0,s.jsx)(c.Z,{sx:{fontSize:3},children:"Notebook editor"})}),"properties"!==q&&(0,s.jsx)(l.Z,{children:(0,s.jsx)(f.Z$,{notebookId:e})}),E&&C&&(0,s.jsx)(l.Z,{children:(0,s.jsx)(d.r,{variant:"invisible",size:"small",leadingVisual:k.jcu,onClick:U,children:"Clone"})})]})}),E&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(h.Z,{sx:{mt:3,mb:3},children:[(0,s.jsx)(h.Z.Link,{href:"",selected:"notebook"===q,onClick:e=>z("notebook",e),children:"Notebook"}),(0,s.jsx)(h.Z.Link,{href:"",selected:"properties"===q,onClick:e=>z("properties",e),children:"Properties"})]}),"notebook"===q&&(0,s.jsx)(l.Z,{children:E.nbformat?(0,s.jsx)(x.a,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",readOnly:!1,cellMetadataPanel:!0,nbgrader:!1,nbformat:E.nbformat,CellSidebar:y.Q}):(0,s.jsx)(s.Fragment,{})}),"properties"===q&&(0,s.jsx)(l.Z,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,s.jsx)(l.Z,{children:(0,s.jsxs)(l.Z,{sx:{label:{marginTop:2}},children:[(0,s.jsxs)(u.Z,{children:[(0,s.jsx)(u.Z.Label,{children:"Name"}),(0,s.jsx)(p.Z,{block:!0,value:R.name,onChange:e=>{_((o=>({...o,name:e.target.value})))}}),!1===M.name&&(0,s.jsx)(u.Z.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,s.jsxs)(u.Z,{children:[(0,s.jsx)(u.Z.Label,{children:"Description"}),(0,s.jsx)(m.ZP,{block:!0,value:R.description,onChange:e=>{_((o=>({...o,description:e.target.value})))}}),!1===M.description&&(0,s.jsx)(u.Z.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,s.jsx)(u.Z,{children:(0,s.jsx)(d.r,{variant:"primary",disabled:!M.name||!M.description,sx:{marginTop:2},onClick:async()=>{Z.layout().showBackdrop(),F(e,R.name,R.description).then((e=>{e.success&&(P("The notebook is successfully updated.",{variant:"success"}),Z.layout().triggerItemsRefresh(),O({...E,name:R.name,description:R.description}))})).finally((()=>{Z.layout().hideBackdrop()}))},children:"Update notebook"})})]})})})]})]})},Z=g}}]);