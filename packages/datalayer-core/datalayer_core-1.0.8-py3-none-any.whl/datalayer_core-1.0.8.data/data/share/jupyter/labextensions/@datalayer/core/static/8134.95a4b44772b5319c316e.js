"use strict";(self.webpackChunk_datalayer_core=self.webpackChunk_datalayer_core||[]).push([[8134],{98134:(e,o,t)=>{t.r(o),t.d(o,{NotebookEdit:()=>u,default:()=>p});var a=t(74512),r=t(83887),s=t(99608),n=t(71082),i=t(23189),l=t(58497),c=t(85278),d=t(43712),h=t(42799);const u=()=>{const{notebookId:e}=(0,s.UO)();if(!e)return(0,a.jsx)(a.Fragment,{});const o=(0,d.aF)(),t=(0,n.useConfirm)(),u=(0,d.s0)(),p=(0,h.qX)(),m=(0,l.useNotebookStore)(),x=p.layout().space,b=(0,h.D1)().saveRequest,k=m.selectNotebookModel(e),{cloneNotebook:f,getNotebook:y,refreshNotebook:v,updateNotebook:j,updateNotebookModel:g}=(0,d.YT)(),{enqueueToast:C}=(0,d.pm)(),[B,N]=(0,r.useState)("notebook"),[F,T]=(0,r.useState)(),[S,w]=(0,r.useState)({name:"",description:""}),[I,P]=(0,r.useState)({name:void 0,description:void 0}),D=(e,o)=>{o.preventDefault(),p.layout().resetRightPortal(),"properties"===e&&E(),N(e)};(0,r.useEffect)((()=>("notebook"===B&&(p.layout().showBackdrop(),v(e).then((o=>{if(p.layout().hideBackdrop(),o.success){const o=y(e);o?(T(o),p.layout().setItem(o),w({name:o.name,description:o.description})):u("/")}})).finally((()=>{p.layout().hideBackdrop()}))),()=>{T(void 0),m.reset(),p.layout().setItem(void 0)})),[e]);const E=()=>{k?.model?.cells&&(p.layout().showBackdrop("Saving the notebook..."),g(e,k.model.toJSON()).then((e=>{e.success&&(C("The notebook is successfully updated.",{variant:"success"}),T({...F,nbformat:k.model.toJSON()}))})).finally((()=>{p.layout().hideBackdrop()})))};(0,r.useEffect)((()=>{b&&F&&E()}),[b]),(0,r.useEffect)((()=>{P({...I,name:void 0===S.name?void 0:S.name.length>2,description:void 0===S.description?void 0:S.description.length>2})}),[S]);const L=(0,r.useCallback)((async a=>{t({title:"Are you sure?",content:"Please confirm you want to clone this notebook in your private library."}).then((t=>{t&&(p.layout().showBackdrop(),f(e).then((e=>{p.layout().hideBackdrop(),e.success&&(C(e.message,{variant:"success"}),p.layout().triggerItemsRefresh(),u(`/${o.handle}/library/notebooks`))})))}))}),[t,F]);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.Pagehead,{children:(0,a.jsxs)(n.Box,{display:"flex",children:[(0,a.jsx)(n.Box,{flex:1,children:(0,a.jsx)(n.Heading,{sx:{fontSize:3},children:"Notebook editor"})}),"properties"!==B&&(0,a.jsx)(n.Box,{children:(0,a.jsx)(c.Z$,{notebookId:e})}),F&&x&&(0,a.jsx)(n.Box,{children:(0,a.jsx)(n.Button,{variant:"invisible",size:"small",leadingVisual:i.jcu,onClick:L,children:"Clone"})})]})}),F&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.TabNav,{sx:{mt:3,mb:3},children:[(0,a.jsx)(n.TabNav.Link,{href:"",selected:"notebook"===B,onClick:e=>D("notebook",e),children:"Notebook"}),(0,a.jsx)(n.TabNav.Link,{href:"",selected:"properties"===B,onClick:e=>D("properties",e),children:"Properties"})]}),"notebook"===B&&(0,a.jsx)(n.Box,{children:F.nbformat?(0,a.jsx)(l.Notebook,{id:e,height:"calc(100vh - 240px)",maxHeight:"calc(100vh - 240px)",readOnly:!1,cellMetadataPanel:!0,nbgrader:!1,nbformat:F.nbformat,CellSidebar:l.CellSidebar}):(0,a.jsx)(a.Fragment,{})}),"properties"===B&&(0,a.jsx)(n.Box,{display:"grid",gridTemplateColumns:"1fr 1fr",children:(0,a.jsx)(n.Box,{children:(0,a.jsxs)(n.Box,{sx:{label:{marginTop:2}},children:[(0,a.jsxs)(n.FormControl,{children:[(0,a.jsx)(n.FormControl.Label,{children:"Name"}),(0,a.jsx)(n.TextInput,{block:!0,value:S.name,onChange:e=>{w((o=>({...o,name:e.target.value})))}}),!1===I.name&&(0,a.jsx)(n.FormControl.Validation,{variant:"error",children:"Name must have more than 2 characters."})]}),(0,a.jsxs)(n.FormControl,{children:[(0,a.jsx)(n.FormControl.Label,{children:"Description"}),(0,a.jsx)(n.Textarea,{block:!0,value:S.description,onChange:e=>{w((o=>({...o,description:e.target.value})))}}),!1===I.description&&(0,a.jsx)(n.FormControl.Validation,{variant:"error",children:"Description must have more than 2 characters."})]}),(0,a.jsx)(n.FormControl,{children:(0,a.jsx)(n.Button,{variant:"primary",disabled:!I.name||!I.description,sx:{marginTop:2},onClick:async()=>{p.layout().showBackdrop(),j(e,S.name,S.description).then((e=>{e.success&&(C("The notebook is successfully updated.",{variant:"success"}),p.layout().triggerItemsRefresh(),T({...F,name:S.name,description:S.description}))})).finally((()=>{p.layout().hideBackdrop()}))},children:"Update notebook"})})]})})})]})]})},p=u}}]);