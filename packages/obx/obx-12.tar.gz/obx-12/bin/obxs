#!/usr/bin/env python3
# This file is placed in the Public Domain.
# pylint: disable=C0411,C0413,W0212,W0718,E0401


"main"


import os
import sys


from obx.persist import skel
from obx.errors  import errors, later
from obx.main    import init, scan, wrap
from obx.runtime import Cfg
from obx.utils   import forever, modnames, pidfile, privileges


from obx import modules


Cfg.mod = ",".join(modnames(modules))


def main():
    "main"
    privileges(Cfg.user)
    skel()
    pidfile(Cfg.pidfile)
    scan(Cfg.mod, modules)
    init(Cfg.mod, modules)
    forever()


if __name__ == "__main__":
    wrap(main)
