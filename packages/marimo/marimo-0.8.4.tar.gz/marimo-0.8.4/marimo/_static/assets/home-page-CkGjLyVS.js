import{c as e,R as s,F as a,a as t,u as o,r as n,b as r,d as i,j as l,S as c,I as d,e as h,C as x,L as p,f as m,g as u,B as f,h as g,i as j,k as v,l as y,m as b,n as w,o as N,E as k,t as C,p as z,T as S,A as T,q as I,s as M,M as P,v as D,w as $,x as R,y as A,z as O,D as B,P as W,G as _}from"./index-m3GIsG_G.js";import{u as H,C as E,S as q,T as F,M as Y,P as G}from"./tree-D25uhHQO.js";import"./index-DBo8A-Q_.js";
/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=e("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]),U=e("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]),V=e("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),X=s.createContext({runningNotebooks:new Map,root:"",setRunningNotebooks:a.NOOP}),J=t("marimo:home:include-markdown",!1,void 0,{getOnInit:!0}),K=t("marimo:home:expanded-folders",{},void 0,{getOnInit:!0});
/**
 * @license lucide-react v0.428.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function Q(e){return`${R()}-${encodeURIComponent(e)}`}const Z=()=>{const[e,s]=o(J),[a,t]=n.useState(""),[u,f]=n.useState(0),g=r((()=>A()),[]),j=r((()=>O({includeMarkdown:e})),[e]);H((()=>{f((e=>e+1))}),{delayMs:1e4,whenVisible:!0});const v=r((async()=>{const e=await B();return P.keyBy(e.files,(e=>e.path))}),[u]),y=i(g,j,v);if(y.error)throw y.error;const b=y.data;if(!b)return l.jsx(c,{centered:!0,size:"xlarge"});const[w,N,k]=b;return l.jsx(n.Suspense,{children:l.jsxs(X.Provider,{value:{runningNotebooks:k,root:N.root,setRunningNotebooks:v.setData},children:[l.jsxs("div",{className:"absolute top-3 right-5 flex gap-2 z-10",children:[l.jsx(E,{showAppConfig:!1}),l.jsx(q,{description:`This will shutdown the notebook server and terminate all running notebooks (${k.size}). You'll lose all data that's in memory.`})]}),l.jsxs("div",{className:"flex flex-col gap-6 max-w-5xl container pt-5 pb-20 z-10",children:[l.jsx("img",{src:"logo.png",alt:"marimo logo",className:"w-64 mb-4"}),l.jsx(le,{}),l.jsx(oe,{header:l.jsx(ne,{Icon:U,children:"Running notebooks"}),files:[...k.values()],openNewTab:!1}),l.jsx(oe,{header:l.jsx(ne,{Icon:V,children:"Recent notebooks"}),files:w.files,openNewTab:!0}),l.jsxs("div",{className:"flex flex-col gap-2",children:[l.jsxs(ne,{Icon:L,control:l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx(d,{id:"search",value:a,icon:l.jsx(h,{size:13}),onChange:e=>t(e.target.value),placeholder:"Search",className:"mb-0 border-border"}),l.jsx(ee,{}),l.jsx(x,{"data-testid":"include-markdown-checkbox",id:"include-markdown",checked:e,onCheckedChange:e=>s(Boolean(e))}),l.jsx(p,{htmlFor:"include-markdown",children:"Include markdown"})]}),children:["Workspace",l.jsx(m,{className:"w-4 h-4 ml-1 cursor-pointer opacity-70 hover:opacity-100",onClick:()=>j.reload()}),j.loading&&l.jsx(c,{size:"small"})]}),l.jsx("div",{className:"flex flex-col divide-y divide-[var(--slate-3)] border rounded overflow-hidden max-h-[48rem] overflow-y-auto shadow-sm bg-background",children:l.jsx(se,{searchText:a,files:N.files})})]})]})]})})},ee=()=>{const e=u(K);return l.jsxs(f,{variant:"text",size:"sm",className:"h-fit",onClick:()=>{e({})},children:[l.jsx(g,{className:"w-4 h-4 mr-1"}),"Collapse all"]})},se=({files:e,searchText:s})=>{const[a,t]=o(K),r=0===Object.keys(a).length,i=n.useRef();return n.useEffect((()=>{var e;r&&(null==(e=i.current)||e.closeAll())}),[r]),0===e.length?l.jsx("div",{className:"flex flex-col px-5 py-10 items-center justify-center",children:l.jsx("p",{className:"text-center text-muted-foreground",children:"No files in this workspace"})}):l.jsx(F,{ref:i,width:"100%",height:500,searchTerm:s,className:"h-full",idAccessor:e=>e.path,data:e,openByDefault:!1,initialOpenState:a,onToggle:async e=>{const s=a[e]??!1;t({...a,[e]:!s})},padding:5,rowHeight:35,indent:15,overscanCount:1e3,renderCursor:()=>null,disableDrop:!0,disableDrag:!0,disableEdit:!0,disableMultiSelection:!0,children:ae})},ae=({node:e,style:s})=>{const a=e.data.isDirectory?"directory":j(e.data.name),t=_[a],o=l.jsx(t,{className:"w-5 h-5 flex-shrink-0",strokeWidth:1.5}),r=n.useContext(X).root;return l.jsxs("div",{style:s,className:v("flex items-center cursor-pointer ml-1 text-muted-foreground whitespace-nowrap group h-full"),onClick:s=>{s.stopPropagation(),e.data.isDirectory&&e.toggle()},children:[l.jsx(te,{node:e}),(()=>{const s="flex items-center pl-1 cursor-pointer hover:bg-accent/50 hover:text-accent-foreground rounded-l flex-1 overflow-hidden h-full pr-3 gap-2";if(e.data.isDirectory)return l.jsxs("span",{className:s,children:[o,e.data.name]});const a=e.data.path.startsWith(r)&&W.isAbsolute(e.data.path)?W.rest(e.data.path,r):e.data.path,t=a.endsWith(".md");return l.jsxs("a",{className:s,href:N(`?file=${a}`).toString(),target:Q(a),children:[o,l.jsxs("span",{className:"flex-1 overflow-hidden text-ellipsis",children:[e.data.name,t&&l.jsx(Y,{className:"ml-2 inline opacity-80"})]}),l.jsx(ie,{filePath:a}),l.jsx(k,{size:20,className:"group-hover:opacity-100 opacity-0 text-primary"})]})})()]})},te=({node:e})=>e.data.isDirectory?e.isOpen?l.jsx(y,{className:"w-5 h-5 flex-shrink-0"}):l.jsx(b,{className:"w-5 h-5 flex-shrink-0"}):l.jsx("span",{className:"w-5 h-5 flex-shrink-0"}),oe=({header:e,files:s,openNewTab:a})=>0===s.length?null:l.jsxs("div",{className:"flex flex-col gap-2",children:[e,l.jsx("div",{className:"flex flex-col divide-y divide-[var(--slate-3)] border rounded overflow-hidden max-h-[48rem] overflow-y-auto shadow-sm bg-background",children:s.map((e=>l.jsx(re,{file:e,openNewTab:a},e.path)))})]}),ne=({Icon:e,control:s,children:a})=>l.jsxs("div",{className:"flex items-center justify-between gap-2",children:[l.jsxs("h2",{className:"flex items-center gap-2 text-xl font-semibold text-muted-foreground select-none",children:[l.jsx(e,{className:"h-5 w-5"}),a]}),s]}),re=({file:e,openNewTab:s})=>{const a=w(e.path),t=N(a?`?file=${e.initializationId}&session_id=${e.path}`:`?file=${e.path}`),o=e.path.endsWith(".md");return l.jsxs("a",{className:"py-1.5 px-4 hover:bg-[var(--blue-2)] hover:text-primary transition-all duration-300 cursor-pointer group relative flex gap-4 items-center",href:t.toString(),target:s?Q(e.initializationId||e.path):"",children:[l.jsxs("div",{className:"flex flex-col justify-between flex-1",children:[l.jsxs("span",{className:"flex items-center gap-2",children:[e.name,o&&l.jsx("span",{className:"opacity-80",children:l.jsx(Y,{})})]}),l.jsx("p",{title:e.path,className:"text-sm text-muted-foreground overflow-hidden whitespace-nowrap overflow-ellipsis",children:e.path})]}),l.jsxs("div",{className:"flex flex-col gap-1 items-end",children:[l.jsxs("div",{className:"flex gap-3 items-center",children:[l.jsx("div",{children:l.jsx(ie,{filePath:e.path})}),s&&l.jsx(k,{size:20,className:"group-hover:opacity-100 opacity-0 transition-all duration-300 text-primary"})]}),!!e.lastModified&&l.jsx("div",{className:"text-xs text-muted-foreground opacity-80",children:C(1e3*e.lastModified)})]})]},e.path)},ie=({filePath:e})=>{const{openConfirm:s,closeModal:a}=z(),{runningNotebooks:t,setRunningNotebooks:o}=n.useContext(X);return t.has(e)?l.jsx(S,{content:"Shutdown",children:l.jsx(f,{size:"icon",variant:"outline",className:"opacity-80 hover:opacity-100 hover:bg-accent text-destructive border-destructive hover:border-destructive hover:text-destructive bg-background hover:bg-[var(--red-1)]",onClick:n=>{n.stopPropagation(),n.preventDefault(),s({title:"Shutdown",description:"This will terminate the Python kernel. You'll lose all data that's in memory.",variant:"destructive",confirmAction:l.jsx(T,{onClick:s=>{const n=t.get(e);I(n),M({sessionId:n.sessionId}).then((e=>{o(P.keyBy(e.files,(e=>e.path)))})),a(),D({description:"Notebook has been shutdown."})},"aria-label":"Confirm Shutdown",children:"Shutdown"})})},children:l.jsx(G,{size:14})})}):null},le=()=>{const e=`__new__${$()}`;return l.jsxs("a",{className:"relative rounded-lg p-6 group\n      text-primary hover:bg-[var(--blue-2)] shadow-mdSolid shadow-accent border\n      transition-all duration-300 cursor-pointer\n      ",href:N(`?file=${e}`).toString(),target:Q(e),children:[l.jsx("h2",{className:"text-lg font-semibold",children:"Create a new notebook"}),l.jsx("div",{className:"group-hover:opacity-100 opacity-0 absolute right-5 top-0 bottom-0 rounded-lg flex items-center justify-center transition-all duration-300",children:l.jsx(k,{size:24})})]})};export{Z as default};
