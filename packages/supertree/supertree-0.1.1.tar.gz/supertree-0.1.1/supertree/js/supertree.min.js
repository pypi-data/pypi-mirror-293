function t(t="st-licence-KEY",e="data/histgradientbug.json",a="$treetemplate"){const s="debug";function l(t,e,a="Data;"){const l=["debug","custom","info","warning","error"];l.indexOf(t)>=l.indexOf(s)&&console.log(`[${t.toUpperCase()}]:`,a,e)}l("debug",t),async function(t,e=5e3){const a=Date.now(),s=document.querySelector(t);if(!s)throw new Error(`Div with selector ${t} does not exist.`);for(;Date.now()-a<e;){if("undefined"!=typeof d3)return l("info","D3.js successfully loaded"),!0;await new Promise((t=>setTimeout(t,100)))}return l("warning","D3.js not loaded after timeout"),s.innerHTML='\n    <div style="color: red; font-weight: bold;">\n      D3.js library is not loaded. Try Again :(.\n    </div>',!1}("#graph-div-treeID").then((()=>{var s=!1;!function(){try{const a=t,[r,n]=a.split(".");if(!r||!n)throw new Error("Invalid license key format.");let o,i;try{o=nacl.util.decodeBase64(r)}catch(t){throw new Error("Bad key")}try{i=nacl.util.decodeBase64(n)}catch(t){throw new Error("Bad key fromat: ")}const c=new Uint8Array("6f0de3db182db3c08e4def6f8d49dab4d53fff2b02f8edc71cf7136f68ade82d".match(/.{1,2}/g).map((t=>parseInt(t,16))));s=!1;try{s=nacl.sign.detached.verify(o,i,c)}catch(t){l("error","Bad key:"+t)}var e;try{e=nacl.util.encodeUTF8(o)}catch(t){throw new Error("Bad key")}}catch(t){l("error","Error in verifyKey function:",t)}s&&(s=function(t){const e=t.match(/Date:\s*(\d{2}-\d{2}-\d{4})/);if(e){const t=e[1],[a,s,l]=t.split("-").map(Number);return new Date(l,s-1,a)>new Date}return!1}(e))}(),d3.select("#openModalBtn").attr("class","st-option-button"),d3.select("#graph-div-treeID").attr("class","st-body-tree-div-treeID");let r=Math.random();!function(){let t=document.getElementsByTagName("body")[0],e=`\n    <div id="myModal-treeID" class="st-modal">\n        <div class="st-modal-content">\n           <span id="closeBtn-treeID" class="st-closeBtn">&times;</span>\n            <div id="st-info-div-treeID" class="st-info-div"></div>\n            <div id = "toolbar-treeID" class="st-toolbar"></div>\n            <div id ="graph-div-treeID" class ="st-tree-div-${r}"></div>\n        </div>\n    </div>\n    `;t.insertAdjacentHTML("beforeend",e)}();d3.select("#toolbar-treeID").append("button").html('<svg style="display: inline" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 8v-2a2 2 0 0 1 2 -2h2" /><path d="M4 16v2a2 2 0 0 0 2 2h2" /><path d="M16 4h2a2 2 0 0 1 2 2v2" /><path d="M16 20h2a2 2 0 0 0 2 -2v-2" /></svg>').attr("class","st-option-button").attr("id","openModalBtn-treeID");let n=document.getElementById("myModal-treeID"),o=document.getElementById("openModalBtn-treeID"),i=document.getElementById("closeBtn-treeID");const c="regression",d="classification";let p=!1,y=!0,h=!0;let f=!1,u=0;const m=150,x=80,g=m,b=90,v=110,k=195,w=["#FEFEBB","#c7e9b4","#41b6c4","#FEFECD","#CFE2D4","#4575B4","#313695","#FEE090","#006400","#A6BDDB","#444443","#FFFF00","#00FF00","#0000FF","#FFA500","#800080","#FF00FF","#00FFFF","#FFC0CB","#808080","#800000","#008000","#000080","#FFFFE0","#00FA9A","#ADD8E6","#FF4500","#EE82EE","#20B2AA","#778899","#B22222","#7FFF00","#4682B4","#DAA520","#4B0082","#D2691E","#5F9EA0","#FF1493","#696969","#DC143C","#00CED1","#FFD700","#9932CC","#8B4513","#00BFFF","#FF69B4","#A9A9A9","#B22222","#32CD32","#1E90FF","#FF8C00","#BA55D3","#8B0000","#48D1CC","#DDA0DD","#FF6347","#2E8B57","#6495ED","#FFA07A","#9370DB","#8B008B","#839d9a","#bfd2bf","#a37774","#124559","#c0c5c1","#46351d","#7d8491","#01161e","#f1fffa","#eff6e0","#d5c7bc","#93b7be","#785964","#646f4b","#598392","#eaf0ce","#bbbe64","#454545","#443850","#aec3b0","#4b444c","#9196a0","#79625d","#fba64c","#38353e","#a46848","#453e2a","#c8b496","#2e1515","#be9668","#541e13","#715a3b","#403f4a","#17090c","#60606a","#dcd1b8","#3f2926","#d03c32","#9e8676","#aeb0b2","#d75841","#e3aa71","#de5d70","#544540","#335f9e","#ab9682","#150a2b","#171559","#d6d169","#450c3d","#913362","#2b7873","#2b9e62","#65aacf","#1f1718","#67d95f","#a61e49","#f2c6b8","#e6e3d8","#eb9494","#794d81","#ffd8a9","#ff5b4f","#4a3778","#ffb366","#ad82cf","#7e9770","#f39d91","#a9548a","#d38e84","#8455a9","#814d6e","#5d7668","#f2af92","#533a44","#ffffe1","#9e2081","#235a63","#c92e70","#c37289","#a83a94","#db5989","#4c55ba","#77c1eb","#f68484","#acfff1","#ffce96","#512b8c","#1f4572","#221330","#422452","#d4ffb0","#50cc9a","#74ff86","#201a47","#2c8a9a","#000000","#782b8c","#fffab2","#fdffef","#094d18","#449481","#f0cc69","#df5f36","#555555","#497a3a","#beb866","#819650","#7294d6","#5b2b7c","#ffffff","#aaaaaa","#000000","#8cdaff","#f0a34a","#9f1d2e","#5b59b3","#4b0f37","#63b9bb","#227944"];var A=d3.selectAll("#myModal-treeID").append("div").attr("class","st-tooltip").style("position","absolute").style("opacity",0),_=d3.selectAll("body").append("div").attr("class","st-tooltip").style("position","absolute").style("opacity",0).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none");(async function(){try{let s;if("$treetemplate"!=a){var t=a;s={nodeData:t.node_data,treeData:t.tree_data}}else{const[t]=await Promise.all([fetch(e)]);if(!t.ok)throw new Error("Network response was not ok");const a=await t.json();l("info",a),s={nodeData:a.node_data,treeData:a.tree_data}}return s}catch(t){l("error","Error loading JSON files:")}})().then((t=>{if(t){const{nodeData:O,treeData:P}=t;let H=0;let N=function t(e){return l("debug",e,"Node w convertData"),e.id=H++,e.is_leaf?{children:[],...e}:{children:[t(e.left_node),t(e.right_node)],...e}}(O),q={top:20,right:90,bottom:160,left:90},R=2500-q.left-q.right,U=1100-q.top-q.bottom;var e=0;const G=1250;let K=w.slice(0,20);if(P.feature_names.length>K.length){let et=P.feature_names.length-K.length;function a(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}for(let at=0;at<et;at++)K.push(a())}var D=d3.zoom().scaleExtent([.05,5]).on("zoom",(function(t){$.attr("transform",t.transform)}));function E(){if("block"===document.getElementById("myModal-treeID").style.display){var t=(a=document.getElementsByClassName(`st-tree-div-${r}`))[0].clientWidth,e=a[0].clientHeight;svgElement=d3.select(a[0]).select("svg#mySVG-treeID")}else{var a;t=(a=document.getElementsByClassName("st-body-tree-div-treeID"))[0].clientWidth,e=a[0].clientHeight;svgElement=d3.select(a[0]).select("svg#mySVG-treeID")}let s=1;s=R<t?1:t/R,s=Math.max(.05,s);let l=d3.zoomIdentity.translate(-W.x*s+t/2,W.y*s+e/15).scale(s);svgElement.transition().duration(G).call(D.transform,l)}i.onclick=function(){n.style.display="none",E()},window.onclick=function(t){t.target==n&&(n.style.display="none",E())},o.onclick=function(){n.style.display="block",E()};let W=d3.hierarchy(N);W.x0=0,W.y0=R/2;var F=0,M=0;!function t(e){F=Math.max(F,e.depth),e.children?e.children.forEach((function(e){t(e)})):M++}(W),R=300*M,U=400*F;var $=d3.selectAll("#graph-div-treeID").append("svg").attr("width",R+q.right+q.left).attr("height",U+q.top+q.bottom).attr("id","mySVG-treeID").attr("class","st-svg").call(D).append("g").attr("transform","translate("+q.left+","+q.top+")"),B="$depth";function z(t,a){maxSample=-1/0,minSample=1/0,M=0,function t(e){e.children?e.children.forEach((function(e){t(e)})):M++}(W),R=300*M,U=400*F;let s=d3.tree().size([R,U])(W),r=s.descendants(),n=s.descendants().slice(1);r.forEach((function(t){t.y=180*t.depth,t.hasOwnProperty("cx")||(t.cx=1*t.x),t.hasOwnProperty("cy")||(t.cy=1*t.y)})),a&&($.selectAll(".treeNode").remove(),$.selectAll(".link").remove(),e=0),r.forEach((function(t){l("debug","AAAAAAAAAAAAAAA"),t.y0=t.y,t.x0=t.x}));var o=$.selectAll(".treeNode").data(W.descendants(),(function(t){return t.id||(t.id=++e)}));function i(t,e=[]){return t._children&&t._children.forEach((function(t){e.push(t),i(t,e)})),t.children&&t.children.forEach((function(t){e.push(t),i(t,e)})),e}let w=i(t).map((function(t){return t.id}));w.push(t.id);var D=o.enter().append("g").attr("class","treeNode").attr("transform",(e=>"translate("+t.cx+","+t.cy+")")).on("click",Z);let E=P.data_feature[0].length;var B=Array.from({length:E},(()=>[1/0,-1/0])),I=Array.from({length:E},(()=>[0,-1/0]));for(let t=0;t<E;t++){let e=[];for(let a=0;a<P.data_feature.length;a++)e.push(P.data_feature[a][t]);let a=d3.extent(e);B[t][0]=Math.min(B[t][0],a[0]),B[t][1]=Math.max(B[t][1],a[1])}for(let t=0;t<E;t++)B[t][0]-=.2,B[t][1]+=.2;P.tree_type==c&&(D.each((function(t){if(!t.data.is_leaf){let a=P.data_feature.map((e=>e[t.data.feature])).map(((t,e)=>[t,P.data_target[e]])),s=new Set;t.data.start_end_x_axis.forEach(((t,e)=>{"notexist"!=t[0]&&P.data_feature.forEach(((a,l)=>{a[e]>t[0]&&s.add(l)})),"notexist"!=t[1]&&P.data_feature.forEach(((a,l)=>{a[e]<t[1]&&s.add(l)}))}));let l=Array.from(new Set([...s]));l.sort(((t,e)=>e-t)),l.forEach((t=>{t>=0&&t<a.length&&a.splice(t,1)})),d3.select(this).append("rect").attr("class","histogram-background").attr("x",-100).attr("y",-10).attr("width",k).attr("height",v).attr("stroke-width",1).attr("stroke","#545454").attr("rx",10).attr("ry",10).style("fill","#ffffff");let r=a.map((t=>t[0]));const n=function(t,e){let a=0,s=0,l=0,r=0;return t.forEach((t=>{t[0]<e?(a+=t[1],s++):(l+=t[1],r++)})),{averageBelowThreshold:a/s,averageAboveOrEqualThreshold:l/r}}(a,t.data.threshold),o=d3.scaleLinear().domain(d3.extent(r)).nice().range([0,g]),i=o.domain(),c=[i[0],t.data.threshold,i[1]];d3.select(this).append("g").attr("transform","translate(-75, 80)").attr("class","xAxis").call(d3.axisBottom(o).tickSize(0).tickValues(c).tickPadding(8)).selectAll(".tick").attr("class","xAxis-text").style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none").style("fill","black"),d3.select(this).selectAll(".domain").style("stroke","black");const d=d3.scaleLinear().domain(d3.extent(P.data_target)).nice().range([80,0]);d3.select(this).append("g").call(d3.axisLeft(d).tickSize(0).ticks(4).tickPadding(4)).call((t=>t.select(".domain"))).attr("transform","translate(-75, 0)").attr("class","yAxis").selectAll(".tick").attr("class","yAxis-text").style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none").style("fill","black"),d3.select(this).selectAll(".domain").style("stroke","black");const p=function(t){_.style("opacity",1),d3.select(this).style("fill","red"),A.style("opacity",1),d3.select(this).style("fill","red")},y=function(t){_.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("fill","blue"),A.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("fill","blue")},h=function(t){_.style("opacity",1),d3.select(this).style("stroke","red"),A.style("opacity",1),d3.select(this).style("stroke","red")},f=function(t){_.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("stroke","black"),A.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("stroke","black")},u=function(t,e){_.html(`<b>(X,Y):</b> (${e[0]},${e[1]})`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>(X,Y):</b> (${e[0]},${e[1]})`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")};d3.select(this).append("g").selectAll("g").data(a).join("circle").attr("cx",((t,e)=>o(a[e][0]))).attr("cy",((t,e)=>d(a[e][1]))).attr("r",2).attr("transform","translate(-75, 0)").style("fill","blue").style("fill-opacity",.5).on("mouseover",p).on("mouseleave",y).on("mousemove",u);const m=function(t,e){_.html(`<b>Avarge:</b> ${n.averageBelowThreshold} `).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>Avarge:</b> ${n.averageBelowThreshold} `).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")},x=function(t,e){_.html(`<b>Avarge:</b> ${n.averageAboveOrEqualThreshold} `).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>Avarge:</b> ${n.averageAboveOrEqualThreshold} `).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")},b=function(t,e){_.html(`<b>All Data</b>\n              <br>Impurity: ${e.data.impurity}\n              <br>Samples: ${e.data.samples}\n              <br>Threshold: ${e.data.threshold}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px").style("opacity",1),A.html(`<b>All Data</b>:<br>\n              <br>Impurity: ${e.data.impurity}\n              <br>Samples: ${e.data.samples}\n              <br>Threshold: ${e.data.threshold}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px").style("opacity",1)},w=function(t,e){_.style("opacity",0).style("top","0px").style("left","0px"),A.style("opacity",0).style("top","0px").style("left","0px")};var e=t.data.threshold;d3.select(this).append("line").attr("class","threshold-line").attr("x1",o(e)).attr("x2",o(e)).attr("y1",0).attr("y2",80).attr("stroke","black").attr("transform","translate(-75,0)").attr("stroke-width",2).attr("stroke-dasharray","5,5").style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("line").attr("class","average-line").attr("x1",0).attr("x2",o(e)).attr("y1",d(n.averageBelowThreshold)).attr("y2",d(n.averageBelowThreshold)).attr("stroke","black").attr("transform","translate(-75,0)").attr("stroke-width",2).attr("stroke-dasharray","5,5").on("mouseover",h).on("mouseleave",f).on("mousemove",m).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("line").attr("class","average-line").attr("x1",o(e)).attr("x2",o(i[1])).attr("y1",d(n.averageAboveOrEqualThreshold)).attr("y2",d(n.averageAboveOrEqualThreshold)).attr("stroke","black").attr("transform","translate(-75,0)").attr("stroke-width",2).attr("stroke-dasharray","5,5").on("mouseover",h).on("mouseleave",f).on("mousemove",x),d3.select(this).append("text").attr("class","st-target").attr("x",0).attr("y",125).style("text-anchor","middle").style("font-size","18px").text(P.feature_names[t.data.feature]).on("mousemove",b).on("mouseleave",w).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none")}})),D.each((function(t){if(t.data.is_leaf){let a=P.data_feature.map((e=>e[t.parent.data.feature])).map(((t,e)=>[t,P.data_target[e]])),s=new Set;t.data.start_end_x_axis.forEach(((t,e)=>{"notexist"!=t[0]&&P.data_feature.forEach(((a,l)=>{a[e]>t[0]&&s.add(l)})),"notexist"!=t[1]&&P.data_feature.forEach(((a,l)=>{a[e]<t[1]&&s.add(l)}))}));let r=Array.from(new Set([...s]));r.sort(((t,e)=>e-t)),r.forEach((t=>{t>=0&&t<a.length&&a.splice(t,1)})),d3.select(this).append("rect").attr("class","histogram-background").attr("x",-55).attr("y",-10).attr("width",130).attr("height",100).attr("stroke-width",1).attr("stroke","#545454").attr("rx",10).attr("ry",10).style("fill","#ffffff").on("click",Z);let n=a.map((t=>t[0]));const o=function(t){const e=t.length;return t.reduce(((t,e)=>t+e[1]),0)/e}(a);var e=d3.extent(n);e[0]=e[0]-.2,e[1]=e[1]+.2;const i=d3.scaleLinear().domain(e).nice().range([0,b]),c=d3.scaleLinear().domain(d3.extent(P.data_target)).nice().range([80,0]);d3.select(this).append("g").call(d3.axisLeft(c).tickSize(0).ticks(4).tickPadding(4)).call((t=>t.select(".domain"))).attr("transform","translate(-30, 0)").attr("class","yAxis").style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none").style("fill","black"),d3.select(this).selectAll(".domain").style("stroke","black");const d=function(t){_.style("opacity",1),d3.select(this).style("fill","red"),A.style("opacity",1),d3.select(this).style("fill","red")},p=function(t){_.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("fill","blue"),A.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("fill","blue")},y=function(t){_.style("opacity",1),d3.select(this).style("stroke","red"),A.style("opacity",1),d3.select(this).style("stroke","red")},h=function(t){_.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("stroke","black"),A.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("stroke","black")},f=function(t,e){_.html(`<b>(X,Y):</b> (${e[0]},${e[1]})`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>(X,Y):</b> (${e[0]},${e[1]})`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")},u=function(t,e){_.html(`<b>Avarge:</b> ${o} `).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>Avarge:</b> ${o} `).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")};d3.select(this).append("g").selectAll("g").data(a).join("circle").attr("cx",((t,e)=>i(a[e][0]))).attr("cy",((t,e)=>c(a[e][1]))).attr("r",2).attr("transform","translate(-30, 0)").style("fill","blue").style("fill-opacity",.5).on("mouseover",d).on("mouseleave",p).on("mousemove",f);i.domain();d3.select(this).append("line").attr("class","average-line").attr("x1",0).attr("x2",b).attr("y1",c(o)).attr("y2",c(o)).attr("stroke","black").attr("transform","translate(-30,0)").attr("stroke-width",2).attr("stroke-dasharray","5,5").on("mouseover",y).on("mouseleave",h).on("mousemove",u),d3.select(this).append("text").attr("class","st-target").attr("x",15).attr("y",140).style("text-anchor","middle").style("font-size","18px").text(`n = ${t.data.samples}`).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("text").attr("class","st-target").attr("x",15).attr("y",115).style("text-anchor","middle").style("font-size","18px").text(`${t.data.treeclass} = ${o.toFixed(3)}`).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),l("info",t.data.treeclass)}}))),P.tree_type==d&&(D.each((function(e){if(!e.data.is_leaf){const n=e.data.feature;let o=[...new Set(P.data_target)].map((()=>[]));P.data_feature.forEach(((t,e)=>{const a=P.data_target[e];o[a].push(t)}));var a=[1/0,-1/0];e.data.start_end_x_axis.forEach(((t,e)=>{"notexist"!=t[0]&&o.forEach(((a,s)=>{o[s]=a.filter((a=>a[e]<t[0]))})),"notexist"!=t[1]&&o.forEach(((a,s)=>{o[s]=a.filter((a=>a[e]>t[1]))}))}));let i=o.map((t=>t.map((t=>t[n]))));const c=[];let d=Array.from({length:i.length+c.length},((t,e)=>e));i=i.map(((t,e)=>{const a=t.filter((t=>null!=t));return 0===a.length&&c.push(e),a})).filter((t=>t.length>0));let p=new Set(c);d=d.filter((t=>!p.has(t))),i.map((t=>{var e=d3.extent(t);a[0]=Math.min(a[0],e[0]),a[1]=Math.max(a[1],e[1])})),a[0]=a[0]-.2,a[1]=a[1]+.2,y&&(a=B[n]);const f=d3.scaleLinear().domain(a).range([0,m]);d3.select(this).append("rect").attr("class","histogram-background").attr("x",-100).attr("y",-10).attr("width",k).attr("height",v).attr("stroke-width",1).attr("stroke","#545454").attr("rx",10).attr("ry",10).style("fill","#ffffff").on("click",Z);const u=function(t,e){_.html(`<b>All Data</b>:<br>Class distribution: ${e.data.class_distribution}\n              <br>Impurity: ${e.data.impurity}\n              <br>Samples: ${e.data.samples}\n              <br>Threshold: ${e.data.threshold}\n              <br>Treeclass: ${e.data.treeclass}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px").style("opacity",1),A.html(`<b>All Data</b>:<br>Class distribution: ${e.data.class_distribution}\n              <br>Impurity: ${e.data.impurity}\n              <br>Samples: ${e.data.samples}\n              <br>Threshold: ${e.data.threshold}\n              <br>Treeclass: ${e.data.treeclass}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px").style("opacity",1)},g=function(t,e){_.style("opacity",0).style("top","0px").style("left","0px"),A.style("opacity",0).style("top","0px").style("left","0px")};d3.select(this).append("text").attr("class","st-target").attr("x",0).attr("y",125).style("text-anchor","middle").style("font-size","18px").text(P.feature_names[n]).on("mousemove",u).on("mouseleave",g).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none");const b=f.domain(),w=[b[0],e.data.threshold,b[1]];d3.select(this).append("g").attr("class","xAxis").attr("transform","translate(-75, 80)").call(d3.axisBottom(f).tickSize(0).tickPadding(8).tickValues(w).tickFormat(d3.format(",.1f"))).selectAll(".tick").attr("class","xAxis-text").style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none").style("fill","black"),d3.select(this).selectAll(".domain").style("stroke","black");const D=d3.scaleLinear().range([x,0]),E=d3.select(this).append("g"),F=d3.bin().domain(f.domain()).thresholds(f.ticks(20)),M=i.map((t=>F(t)));l("debug",M,"binsData");const $=d3.stack().keys(d3.range(i.length)).value(((t,e)=>t[e]?t[e].length:0))(d3.transpose(M));var s=[0,0];s[0]=0,s[1]=d3.max($,(t=>d3.max(t,(t=>t[1])))),I[n][1]=Math.max(I[n][1],d3.max($,(t=>d3.max(t,(t=>t[1]))))),h&&(s=I[n]),D.domain(s);const z=D.domain(),S=[z[0],z[0]+(z[1]-z[0])/2,z[1]];E.call(d3.axisLeft(D).tickSize(0).tickPadding(4).tickValues(S).tickFormat(d3.format(",.0f"))).attr("class","yAxis").attr("transform","translate(-75,0)").call((t=>t.select(".domain").remove())).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none").style("fill","black"),d3.select(this).selectAll(".domain").style("stroke","black");const C=function(t){A.style("opacity",1),_.style("opacity",1),d3.select(this).style("stroke","#EF4A60")},X=function(t){A.style("opacity",0).style("top","0px").style("left","0px"),_.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("stroke","black")},Y=function(t,e){_.html(`<b>${P.target_names[e.class]}</b>: ${e[1]-e[0]}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>${P.target_names[e.class]}</b>: ${e[1]-e[0]}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")};let T=e;l("debug",$,"stackedData"),d3.select(this).selectAll("g.layer").data($).enter().append("g").attr("class","layer").style("fill",((t,e)=>K[d[e]])).on("click",(function(){Z(t,T)})).selectAll("rect.bar").data(((t,e)=>t.map((t=>({...t,class:d[e]}))))).enter().append("rect").attr("class","bar").attr("x",(t=>f(t.data[0].x0))).attr("y",(t=>D(t[1]))).attr("height",(t=>D(t[0])-D(t[1]))).attr("width",(t=>f(t.data[0].x1)-f(t.data[0].x0))).attr("transform","translate(-75,0)").attr("stroke","black").on("mouseover",C).on("mouseleave",X).on("mousemove",Y);var r=e.data.threshold;d3.select(this).append("line").attr("class","threshold-line").attr("x1",f(r)).attr("x2",f(r)).attr("y1",0).attr("y2",x).attr("stroke","black").attr("transform","translate(-75,0)").attr("stroke-width",2).attr("stroke-dasharray","5,5")}})),D.each((function(t){if(t.data.is_leaf){var e=0;for(let a=0;a<t.data.class_distribution[0].length;a++)e+=parseFloat(t.data.class_distribution[0][a]);maxSample=Math.max(maxSample,e),minSample=Math.min(minSample,e)}})),maxSample>0&&(u=maxSample),D.each((function(t){if(t.data.is_leaf){t.data.feature;const a=t.data.class_distribution[0],s=[],l=a.map(((t,e)=>({target_name:`${P.target_names[e]}`,classDistributionValue:t,index:e}))).filter((t=>0!==t.classDistributionValue||(s.push(t.index),!1))).map((t=>({target_name:t.target_name,classDistributionValue:t.classDistributionValue})));let r=Array.from({length:a.length},((t,e)=>e)),n=new Set(s);r=r.filter((t=>!n.has(t)));var e=0;for(let a=0;a<t.data.class_distribution[0].length;a++)e+=parseInt(t.data.class_distribution[0][a]);const o=Math.max(20,Math.min(100,100)/2*Math.sqrt(e/maxSample)),i=d3.pie().value((t=>t.classDistributionValue)).sort(null),c=i(l),d=d3.arc().innerRadius(0).outerRadius(o);l.forEach((function(t){t.classDistributionValue=+t.classDistributionValue,t.enabled=!0}));d3.sum(l.map((function(t){return t.enabled?t.classDistributionValue:0})));const p=function(t){_.style("opacity",1),A.style("opacity",1),d3.select(this).style("stroke","#EF4A60")},y=function(t){_.style("opacity",0).style("top","0px").style("left","0px"),A.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("stroke","black")},h=function(t,e){_.html(`<b>${e.data.target_name}</b>: ${e.data.classDistributionValue}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>${e.data.target_name}</b>: ${e.data.classDistributionValue}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")};d3.select(this).selectAll("path").data(c).join("path").attr("class","piechart").attr("d",d).attr("fill",((t,e)=>K[r[e]])).attr("transform",`translate(10,${o})`).attr("stroke","black").on("mouseover",p).on("mouseleave",y).on("mousemove",h).style("stroke-width","2px").each((function(t){this._current=t})),d3.select(this).append("g").attr("text-anchor","middle").selectAll("g").data(c).join("g").attr("transform",((t,e)=>`translate(10,${2*o+20+40*e})`)).each((function(t,e){const a=d3.select(this);a.append("text").attr("class","st-pie-target").attr("x",0).attr("y",0).attr("fill","black").style("text-anchor","middle").style("font-size","18px").text(t.data.target_name).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),a.append("text").attr("class","st-pie-target2").attr("x",0).attr("y",20).attr("fill","black").style("text-anchor","middle").style("font-size","18px").text(t.data.classDistributionValue.toLocaleString()).style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none")}))}}))),"nodata"==P.tree_type&&D.each((function(t){t.data.is_leaf||(d3.select(this).append("rect").attr("class","histogram-background").attr("x",-100).attr("y",-10).attr("width",k).attr("height",v).attr("stroke-width",1).attr("stroke","#545454").attr("rx",10).attr("ry",10).style("fill","#ffffff"),d3.select(this).append("text").attr("dy",".0em").attr("y",10).attr("class","st-target").style("text-anchor","middle").text((t=>"Threshold "+t.data.threshold)).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("text").attr("dy",".0em").attr("y",30).attr("class","st-target").style("text-anchor","middle").text((t=>"Gini "+t.data.impurity)).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("text").attr("dy",".0em").attr("y",50).attr("class","st-target").style("text-anchor","middle").text((t=>"Samples "+t.data.samples)).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("text").attr("dy",".0em").attr("y",70).attr("class","st-target").style("text-anchor","middle").text((t=>"Value ["+t.data.class_distribution+"]")).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("text").attr("dy",".0em").attr("y",90).attr("class","st-target").style("text-anchor","middle").text((t=>"Class "+t.data.treeclass)).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none")),t.data.is_leaf&&(d3.select(this).append("rect").attr("class","histogram-background").attr("x",-80).attr("y",-10).attr("width",155).attr("height",v).attr("stroke-width",1).attr("stroke","#545454").attr("rx",10).attr("ry",10).style("fill","#ffffff"),d3.select(this).append("text").attr("dy",".0em").attr("y",10).attr("class","st-target").style("text-anchor","middle").text((t=>"Samples "+t.data.samples)).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("text").attr("dy",".0em").attr("y",40).attr("class","st-target").style("text-anchor","middle").text((t=>"Value ["+t.data.class_distribution+"]")).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"),d3.select(this).append("text").attr("dy",".0em").attr("y",70).attr("class","st-target").style("text-anchor","middle").text((t=>"Class "+t.data.treeclass)).style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none"))})),D.merge(o).transition().duration(G).tween("logging",(function(e){let a=d3.interpolate(1*t.x0,1*e.x),s=d3.interpolate(1*t.y,1*e.y);return function(t){let l=a(t),r=s(t);e.cx=l,e.cy=r}})).attr("transform",(function(t){return"translate("+1*t.x+","+1*t.y+")"}));let S=[];S=i(t);let C=new Set(S.map((t=>t.id))),X=o.exit().filter((function(t){return C.has(t.id)})).transition().duration(G).attr("transform",(function(e){return"translate("+(t.x+97.5)+","+(t.y0+55)+")"})).attr("font-size","1em").remove();X.selectAll(".st-target").style("fill-opacity",1e-6).style("font-size","0px").attr("x",-97.5).attr("y",0);const Y=d3.scaleLinear().domain(0,10).range([0,1]),T=d3.scaleLinear().domain(10,0).range([1,0]);X.selectAll(".xAxis").attr("transform","translate(-97.5,0)").call(d3.axisBottom(Y).tickSize(0).tickPadding(8).ticks(2).tickFormat(d3.format(",.1f"))),X.selectAll(".yAxis").attr("transform","translate(-97.5,0)").call(d3.axisLeft(T).tickSize(0).tickPadding(8).ticks(2).tickFormat(d3.format(",.1f"))),X.selectAll("rect.histogram-background").attr("width",1e-6).attr("height",1e-6).attr("x",-97.5).attr("y",0),X.selectAll("rect.bar").attr("width",1e-6).attr("height",1e-6).attr("x",-5).attr("y",0),X.selectAll("circle").attr("r",1e-6).attr("cx",-55).attr("cy",0),X.selectAll("path.piechart").attr("transform","translate(-97.5,0)").attr("d",d3.arc().innerRadius(0).outerRadius(1));let V=X.select(".st-grid");X.selectAll("line.threshold-line").attr("transform","translate(-195,-40)").attr("x1",97.5).attr("x2",97.5).attr("y1",40).attr("y2",55).attr("stroke-width",0),X.selectAll("line.average-line").attr("transform","translate(-195,-40)").attr("x1",97.5).attr("x2",97.5).attr("y1",40).attr("y2",40).attr("stroke-width",0),V.selectAll("line").attr("x2",0).attr("y2",0),X.selectAll(".yAxis-text").attr("transform","translate(0,-40)").style("fill-opacity",1e-6).style("font-size","0px").attr("x",0),X.selectAll(".xAxis-text").attr("transform","translate(0,-40)").style("fill-opacity",1e-6).style("font-size","0px"),X.selectAll(".st-pie-target").attr("y",(function(t,e){return-10-2*Math.max(20,Math.min(100,100)/2*Math.sqrt(t.data.classDistributionValue/u))-40*e})).attr("transform","translate(-97.5,0)").style("fill-opacity",1e-6).style("font-size","0px"),X.selectAll(".st-pie-target2").attr("y",(function(t,e){return-10-2*Math.max(20,Math.min(100,100)/2*Math.sqrt(t.data.classDistributionValue/u))-40*e})).attr("transform","translate(-97.5,0)").style("fill-opacity",1e-6).style("font-size","0px");let L=$.selectAll("path.link").data(n,(function(t){return t.id}));var j=L.enter().insert("path","g").attr("class","link").attr("d",(function(e){var a={x:t.cx,y:t.cy};return q(a,a)})).style("fill","none").style("stroke","#555").style("stroke-width","2px").on("mouseover",(function(t){_.style("opacity",1),A.style("opacity",1),d3.select(this).style("stroke","#EF4A60")})).on("mouseleave",(function(t){_.style("opacity",0).style("top","0px").style("left","0px"),A.style("opacity",0).style("top","0px").style("left","0px"),d3.select(this).style("stroke","black")})).on("mousemove",(function(t,e){if(P.tree_type==d){var a=0;for(let t=0;t<e.data.class_distribution[0].length;t++)a+=parseInt(e.data.class_distribution[0][t]);A.html(`<b>Class distribution in link:</b>: ${a}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),_.html(`<b>Class distribution in link:</b>: ${a}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")}if(P.tree_type==c){a=e.data.samples;A.html(`<b>Samples in link:</b>: ${a}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),_.html(`<b>Samples in link:</b>: ${a}`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")}})),H=0,N=0;P.tree_type==c&&(N=O.samples);for(let t=0;t<O.class_distribution[0].length;t++)H+=parseInt(O.class_distribution[0][t]);1==p&&(P.tree_type==d&&j.each((function(t){var e=0;for(let a=0;a<t.data.class_distribution[0].length;a++)e+=parseInt(t.data.class_distribution[0][a]);d3.select(this).style("stroke-width",Math.max(e/H*20,1))})),P.tree_type==c&&j.each((function(t){currentSamples=t.data.samples,d3.select(this).style("stroke-width",Math.max(currentSamples/N*20,1))}))),j.merge(L).transition().duration(G).attr("d",(function(t){return q(t.parent,t)}));L.exit().filter((function(t){return C.has(t.id)})).transition().duration(G).attr("d",(function(e){var a={x:t.x,y:t.y0};return q(a,a)})).remove();function q(t,e){return path=`M ${1*t.x} ${1*t.y}\n            C ${(1*t.x+1*e.x)/2} ${1*t.y},\n              ${(1*t.x+1*e.x)/2} ${1*e.y},\n              ${1*e.x} ${1*e.y}`,path}function Z(t,e){f||(l("debug"," Collapse click event"),f=!0,d3.selectAll("#st-depth-dropdown").attr("disabled","disabled"),e.children?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null),z(e,!1),setTimeout((()=>{f=!1,d3.selectAll("#st-depth-dropdown").attr("disabled",null)}),G))}}"string"==typeof B&&(B=4,l("debug","aha lol xd")),l("debug",B,"start depth value"),L=0,j=B,L++,(V=W).children&&L==j?(V._children=V.children,V.children=null):V.children.forEach((function(t){C(t,L,j)})),z(W,!1),E(),s||d3.selectAll("#st-info-div-treeID").append("p").text("Free for non-commercial use and evaluation").style("font-size","12px").style("color","black");const Z=function(t){_.style("opacity",1),A.style("opacity",1)},J=function(t){_.style("opacity",0).style("top","0px").style("left","0px"),A.style("opacity",0).style("top","0px").style("left","0px")},Q=function(t,e){l("info",e),_.html(`<b>${e}</b>`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px"),A.html(`<b>${e}</b>`).style("top",t.pageY-10+"px").style("left",t.pageX+10+"px")};if(d3.select("#openModalBtn-treeID").on("mouseover",Z).on("mouseleave",J).on("mousemove",(function(t){Q(event,"Open modal window")})),s)d3.selectAll("#toolbar-treeID").append("button").html('<svg style="display: inline"  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>').attr("id","svgButton").attr("class","st-option-button").on("click",(function(){var t=document.getElementById("mySVG-treeID"),e=(new XMLSerializer).serializeToString(t),a=new Blob([e],{type:"image/svg+xml;charset=utf-8"}),s=document.createElement("a");s.href=URL.createObjectURL(a),s.download="myDiagram.svg",document.body.appendChild(s),s.click(),document.body.removeChild(s)})).on("mouseover",Z).on("mouseleave",J).on("mousemove",(function(t){Q(event,"Save SVG")}));d3.selectAll("#toolbar-treeID").append("button").html('<svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-vector-spline"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 3m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M3 17m0 1a1 1 0 0 1 1 -1h2a1 1 0 0 1 1 1v2a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1z" /><path d="M17 5c-6.627 0 -12 5.373 -12 12" /></svg>').attr("id","boldLink").attr("class","st-option-button").on("click",(function(){p=!p,z(W,!0)})).on("mouseover",Z).on("mouseleave",J).on("mousemove",(function(t){Q(event,"Change line tickness scalling in reference to samples in child node")})),d3.selectAll("#toolbar-treeID").append("button").html('<svg style="display: inline" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>').attr("id","resetZoom").attr("class","st-option-button").on("click",E).on("mouseover",Z).on("mouseleave",J).on("mousemove",(function(t){Q(event,"Zoom reset")}));if(P.tree_type==d)d3.selectAll("#toolbar-treeID").append("button").html('<svg style="display: inline" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 13v.01" /><path d="M4 9v.01" /><path d="M4 5v.01" /><path d="M17 20l3 -3l-3 -3" /><path d="M4 17h16" /></svg>').attr("id","changeXAxis").attr("class","st-option-button").on("click",(function(){y=!y,z(W,!0)})).on("mouseover",Z).on("mouseleave",J).on("mousemove",(function(t){Q(event,"Change Scale on X Axis")})),d3.selectAll("#toolbar-treeID").append("button").html('<svg style="display: inline" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M11 20h-.01" /><path d="M15 20h-.01" /><path d="M19 20h-.01" /><path d="M4 7l3 -3l3 3" /><path d="M7 20v-16" /></svg>').attr("id","changeYAxis").attr("class","st-option-button").on("click",(function(){h=!h,z(W,!0)})).on("mouseover",Z).on("mouseleave",J).on("mousemove",(function(t){Q(event,"Change Scale on Y Axis")}));const tt=d3.selectAll("#toolbar-treeID");var I=[],S=tt.append("select").attr("id","st-depth-dropdown").attr("class","st-dropdown").on("change",(function(){var t=T(this.value);if(null!=t){if(f)return;f=!0,d3.selectAll("#st-depth-dropdown").attr("disabled","disabled"),C(W,0,t,!0),I.forEach((function(t){z(t,!1)})),S.property("value",Y[t-1]),setTimeout((()=>{f=!1,d3.selectAll("#st-depth-dropdown").attr("disabled",null)}),G),I=[],E()}}));if(s&&P.tree_type==d){let st=tt.append("select").attr("id","st-color-dropdown").attr("class","st-dropdown").on("change",(function(){var t=T(this.value);if(K=w.slice(20*(t-1),20*t),P.feature_names.length>K.length){let a=P.feature_names.length-K.length;function e(){let t="#";for(let e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}for(let s=0;s<a;s++)K.push(e())}z(W,!0)})),lt=[];d3.selectAll(".st-option-button").style("user-select","none").style("-webkit-user-select","none").style("-moz-user-select","none").style("-ms-user-select","none");for(let rt=1;rt<=w.length/20;rt++)lt.push(`Palette = ${rt}`);st.selectAll("option").data(lt).enter().append("option").attr("value",(t=>t)).text((t=>t))}function C(t,e,a,s){if(++e<a){if(t._children){t.children=t._children,t._children=null;var l=!1;1==s&&(l=!0,s=!1)}t.children&&(t.children.forEach((function(t){C(t,e,a,s)})),1==l&&z(t,!1))}else e>a?(t.children&&(t._children=t.children,t.children=null),t._children&&t._children.forEach((function(t){C(t,e,a,s)}))):e==a&&(t.children&&(t._children=t.children,t.children=null),t._children&&t._children.forEach((function(t){C(t,e,a,s)})),1==s&&I.push(t))}setTimeout((function(){logoURL="https://mljar.com/images/logo/logo_blue_white.svg";d3.select("#toolbar-treeID").append("button").attr("class","st-option-button").style("background","transparent").style("border","none").style("cursor","pointer").style("padding","0").style("position","relative").append("img").attr("src",logoURL).style("height","50px")}),100);var X=0;!function t(e,a){a++,X=Math.max(a,X),e.children&&e.children.forEach((function(e){t(e,a)})),e._children&&e._children.forEach((function(e){t(e,a)}))}(W,X);var Y=[];for(let nt=1;nt<=X;nt++)Y.push(`Depth = ${nt}`);function T(t){const e=t.match(/\d+/);return e?parseInt(e[0],10):null}S.selectAll("option").data(Y).enter().append("option").attr("value",(t=>t)).text((t=>t)),S.property("value",Y[Math.min(B-1,Y.length-1)])}var V,L,j}))})).catch((t=>{l("error",t.message)}))}t();