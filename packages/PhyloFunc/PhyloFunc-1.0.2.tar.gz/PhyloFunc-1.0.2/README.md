# PhyloFunc

'PhyloFunc' is a Python package for calculating functional beta-diversity distances by the phylogenetic framework between any sample pairs. It can detect the significance of phylogenetic context in shaping the functional diversity within metaproteomes.

## Installation of package

You can install this package via pip:  
pip install PhyloFunc

## Usage
Once installed, you can use the PhyloFunc package in a Python script or an interactive environment.

### Quick Start

#### Import package

from PhyloFunc. PhyloFunc import PhyloFunc_Distance  
from PhyloFunc. PhyloFunc import PhyloFunc_matirx
#### Script

#### Calculate the distance between the two samples

#### 1.Use the default Genome-COG metaproteomic data file and default phylogenetic tree based on UHGG database
PhyloFunc_Distance()

#### 2. Use a custom metaproteomic data file or custom phylogenetic tree constructed by corresponding metagenomics data
PhyloFunc_Distance(tree_file='phylogenetic_tree_file. nwk', sample_file='metaproteomic_sample_file.csv')

#### Calculate the distance between multiple pairs of samples

#### 1. Use the default taxon-function metaproteomic data file and default phylogenetic tree based on UHGG database
PhyloFunc_matirx()

#### 2. Use a custom metaproteomic data file or custom phylogenetic tree constructed by corresponding metagenomics data
PhyloFunc_matirx(tree_file='phylogenetic_tree_file. nwk', sample_file='metaproteomic_sample_file.csv')

### Parameter
tree_file: This is a file containing phylogenetic trees in Newick format, which can be generated by metagenomics data using software such as MEGA. If no file is provided, the package uses its built-in default tree file, sourced from the UHGG database: bac120_iqtree_v2.0.1.nwk.

sample_file: This is the CSV file containing the Genome-COG metaproteomic data. To generate two sample distances, the file should include four columns named Genome, COG accession, intensity for sample 1 and intensity for sample 2. To generate a distance matrix between multiple samples, the file should include multiple columns, with the first two columns named Genome,COG accession,and the following columns being the intensity for each sample. If no file is provided, the package will use its built-in default sample file from a human gut microbiome experiment referenced in our paper.

### Output
Once the calculation is complete, a value for the phylofunc distance between one or more sample pairs can be output to assess beta diversity.
## Performance optimization
This package improves performance by reducing disk I/O operations and processing data in memory. This enables faster computations when working with large datasets.

## Project structure
PhyloFunc/  
├── __init__.py  
├── PhyloFunc.py  
│   └── The main function code.  
└── data/  
    ├── V49_two_samples.csv  
    │   └── Data file for calculating distance between two samples.  
    ├── V49_panda_species.csv  
    │   └── Data file for calculating distances among multiple samples.  
    └── bac120_iqtree_v2.0.1.nwk  
        └── Phylogenetic tree file.  

## Contribution
Code contributions and improvement suggestions are welcome! You can submit an issue or pull request via GitHub.

## Licence
This project uses an MIT license. For details, see the LICENSE file.

## Application
More detailed usage of the package can be found in"Phylofunc_method"