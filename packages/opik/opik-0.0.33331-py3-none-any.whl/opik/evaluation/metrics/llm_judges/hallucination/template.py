from typing import List


HALLUCINATION_VERDICT = "hallucinated"
FACTUAL_VERDICT = "factual"

VERDICT_KEY = "verdict"
REASON_KEY = "reason"


def generate_query(user_input: str, answer: str, contexts: List[str]) -> str:
    return f"""
    In this task, you will be given an input from user, a context, and an answer.
    The answer is generated by another language model based on the context provided.
    Your goal is to determine if the answer contains any false information by verifying it against the context.

    Specifically, you need to identify whether the answer:

    Contradicts the context.
    Assumes information not present in the context.
    Your response should be the json with 2 keys: '{VERDICT_KEY}' and '{REASON_KEY}'.

    "{VERDICT_KEY}" can correspond to either "{FACTUAL_VERDICT}" or "{HALLUCINATION_VERDICT}"
    - "{FACTUAL_VERDICT}" means the answer is accurate and aligns with the context.
    - "{HALLUCINATION_VERDICT}" means the answer contains false information or makes unsupported assumptions.
    Please ensure to read the input from user, context and answer carefully, before making your decision.

    '{REASON_KEY}' can be any string that provides an explanation of the given verdict.

    The examples of your inputs can be:

    ***
    User input:
    Where do octopuses live?

    Contexts:
    ["Octopus is a mollusk which lives in salty water, for example seas or oceans.]

    Answer:
    Octopuses live in seas and oceans.
    ***
    Your expected output must be in the following json format (provided reason is only an example):
    {{
        "{VERDICT_KEY}": "{FACTUAL_VERDICT}",
        "{REASON_KEY}": "It is directly described in context that octopuses live in seas and oceans."
    }}

    Another example:

    ***
    User input:
    What is the capital of Germany?

    Contexts:
    ["Germany is a european country with its capital in Berlin.", "Germany consists of 16 federal states"]

    Answer:
    Germany is well known for their cars.
    ***
    Your expected output must be in the following json format (provided reason is only an example):
    {{
        "{VERDICT_KEY}": "{HALLUCINATION_VERDICT}",
        "{REASON_KEY}": "There is no information about the cars in the context and the answer."
    }}

    You must always answer "{HALLUCINATION_VERDICT}" if you detected hallucination and "{FACTUAL_VERDICT}" if you haven't detected hallucination.

    Here are your inputs:
    ***
    User input:
    {user_input}

    Answer:
    {answer}

    Contexts:
    {contexts}
    ***

    Please provide your json with '{VERDICT_KEY}' and '{REASON_KEY}' in response.
    """
