"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6312],{84927:function(e,n,t){t.d(n,{V2:function(){return z},WH:function(){return $},qG:function(){return U}});var i=t(73235),r=t(52322),o=t(33379),s=t(89130),l=t(34147),a=t(55010),c=t(60603),d=t(38491),u=t(21993),p=t(2784),h=t(7267),m=t(92506),x=t(71291),f=t(9875),g=t(43984),j=t(65822),y=t(20718);function b(){let e=(0,i._)(["\n  fragment BackfillStepStatusDialogBackfillFragment on PartitionBackfill {\n    id\n    partitionNames\n    partitionSet {\n      name\n      pipelineName\n      repositoryOrigin {\n        repositoryName\n        repositoryLocationName\n      }\n    }\n  }\n"]);return b=function(){return e},e}function v(e){return!!e&&null!==e.partitionSet&&null!==e.partitionNames}let S=e=>{let{backfill:n,onClose:t}=e;return(0,r.jsxs)(m.Vq,{isOpen:!!(null==n?void 0:n.partitionSet),title:"Step status for backfill: ".concat(null==n?void 0:n.id),onClose:t,style:{width:"80vw"},children:[(()=>{if(!v(n))return null;let e=(0,j.kQ)(n.partitionSet.repositoryOrigin.repositoryName,n.partitionSet.repositoryOrigin.repositoryLocationName);return(0,r.jsx)(w,{backfill:n,partitionSet:n.partitionSet,partitionNames:n.partitionNames,repoAddress:e,onClose:t})})(),(0,r.jsx)(m.cN,{topBorder:!0,children:(0,r.jsx)(d.zx,{onClick:t,children:"Done"})})]})},k=(0,s.Ps)(b()),w=e=>{let{backfill:n,partitionSet:t,partitionNames:i,repoAddress:o}=e,[s,l]=(0,p.useState)(60),[a,c]=(0,p.useState)(0),d=(0,p.useMemo)(()=>[{token:"tag",value:"dagster/backfill=".concat(n.id)}],[n.id]),u=(0,f.T)({partitionSetName:t.name,partitionTagName:g.H.Partition,partitionNames:i,pageSize:s,runsFilter:d,repositorySelector:(0,y.$)(o),jobName:t.pipelineName,offset:a,skipQuery:!n});return(0,r.jsx)(x.ux,{partitionNames:i,partitions:u,pipelineName:null==t?void 0:t.pipelineName,repoAddress:o,setPageSize:l,offset:a,setOffset:c})};var C=t(24432),N=t(94655),E=t(78491),P=t(88257),I=t(96569);function R(){let e=(0,i._)(["\n  fragment BackfillTerminationDialogBackfillFragment on PartitionBackfill {\n    id\n    status\n    isAssetBackfill\n    numCancelable\n  }\n"]);return R=function(){return e},e}function _(){let e=(0,i._)(["\n  mutation CancelBackfill($backfillId: String!) {\n    cancelPartitionBackfill(backfillId: $backfillId) {\n      ... on CancelBackfillSuccess {\n        backfillId\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n"]);return _=function(){return e},e}let O=e=>{let{backfill:n,onClose:t,onComplete:i}=e,[s]=(0,o.D)(F),{data:l}=(0,C.a)(N.NG,{variables:{backfillId:(null==n?void 0:n.id)||""},notifyOnNetworkStatusChange:!0,skip:!n}),[a,c]=(0,p.useState)(!1),u=(0,p.useMemo)(()=>{var e;return n&&l&&"PartitionBackfill"===l.partitionBackfillOrError.__typename&&(null===(e=l.partitionBackfillOrError.cancelableRuns)||void 0===e?void 0:e.reduce((e,n)=>(n&&n.runId&&(e[n.runId]=!0),e),{}))||{}},[n,l]);if(!n||!l)return null;let h=n.numCancelable,x=async()=>{c(!0),await s({variables:{backfillId:n.id}}),i(),c(!1),t()};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(m.Vq,{isOpen:!!n&&n.status!==P.Jv3.CANCELED&&(n.isAssetBackfill||!!h),title:"Cancel backfill",onClose:t,children:[n.isAssetBackfill?(0,r.jsx)(m.a7,{children:"Confirm cancellation of asset backfill? This will mark unfinished runs as canceled."}):(0,r.jsxs)(m.a7,{children:["There ",1===h?"is 1 partition ":"are ".concat(h," partitions "),"yet to be queued or launched."]}),(0,r.jsxs)(m.cN,{children:[(0,r.jsx)(d.zx,{intent:"none",onClick:t,children:"Close"}),a?(0,r.jsx)(d.zx,{intent:"danger",disabled:!0,children:"Canceling..."}):(0,r.jsx)(d.zx,{intent:"danger",onClick:x,children:"Cancel backfill"})]})]}),!n.isAssetBackfill&&u&&(0,r.jsx)(I.A,{isOpen:!!n&&(!h||"REQUESTED"!==n.status)&&!!Object.keys(u).length,onClose:t,onComplete:i,selectedRuns:u})]})},L=(0,s.Ps)(R()),F=(0,s.Ps)(_(),E.B);var B=t(57755),A=t(8068),T=t(50309),D=t(23399),M=t(52338);function J(){let e=(0,i._)(["\n  fragment BackfillActionsBackfillFragment on PartitionBackfill {\n    id\n    hasCancelPermission\n    hasResumePermission\n    isAssetBackfill\n    status\n    numCancelable\n\n    ...BackfillStepStatusDialogBackfillFragment\n    ...BackfillTerminationDialogBackfillFragment\n  }\n\n  ","\n  ","\n"]);return J=function(){return e},e}function U(e,n){return!!e.hasCancelPermission&&!!n&&n}let $=e=>{let{backfill:n,canCancelRuns:t,refetch:i}=e,s=(0,h.k6)(),m=(0,M.it)([{token:"tag",value:"dagster/backfill=".concat(n.id)}]),[x,f]=(0,p.useState)(!1),[g,j]=(0,p.useState)(!1),[y]=(0,o.D)(B.g),b=async()=>{let{data:e}=await y({variables:{backfillId:n.id}});if(e&&"ResumeBackfillSuccess"===e.resumePartitionBackfill.__typename)i();else if(e&&"UnauthorizedError"===e.resumePartitionBackfill.__typename)await (0,T.B7)({message:(0,r.jsx)(l.Z,{direction:"column",spacing:4,children:(0,r.jsx)("div",{children:"Attempted to retry the backfill in read-only mode. This backfill was not retried."})}),icon:"error",intent:"danger"});else if(e&&"PythonError"===e.resumePartitionBackfill.__typename){let n=e.resumePartitionBackfill;await (0,T.B7)({message:(0,r.jsx)("div",{children:"An unexpected error occurred. This backfill was not retried."}),icon:"error",intent:"danger",action:{text:"View error",onClick:()=>(0,A._K)({body:(0,r.jsx)(D.T9,{error:n})})}})}},k=n.hasCancelPermission&&(n.isAssetBackfill&&n.status===P.Jv3.REQUESTED||n.numCancelable>0);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.J,{position:"bottom-right",content:(0,r.jsxs)(c.v2,{children:[(0,r.jsx)(c.sN,{text:"View backfill runs",icon:"settings_backup_restore",onClick:()=>s.push(m)}),(0,r.jsx)(c.sN,{disabled:!v(n),text:"View step status",icon:"view_list",onClick:()=>{j(!0)}}),(0,r.jsx)(c.sN,{disabled:!(n.hasResumePermission&&n.status===P.Jv3.FAILED&&n.partitionSet),text:"Resume failed backfill",title:"Submits runs for all partitions in the backfill that do not have a corresponding run. Does not retry failed runs.",icon:"refresh",onClick:()=>b()}),(0,r.jsx)(c.sN,{text:k?"Cancel backfill submission":"Terminate unfinished runs",icon:"cancel",intent:"danger",disabled:!(k||t),onClick:()=>f(!0)})]}),children:(0,r.jsx)(d.zx,{icon:(0,r.jsx)(u.JO,{name:"expand_more"})})}),(0,r.jsx)(S,{backfill:g?n:void 0,onClose:()=>j(!1)}),(0,r.jsx)(O,{backfill:x?n:void 0,onClose:()=>f(!1),onComplete:()=>i()})]})},z=(0,s.Ps)(J(),k,L)},94655:function(e,n,t){t.d(n,{FW:function(){return L},NG:function(){return J}});var i=t(73235),r=t(52322),o=t(3842),s=t(89130),l=t(39013),a=t(35292),c=t(14934),d=t(21993),u=t(43212),p=t(2784),h=t(47933),m=t(35505),x=t(84927),f=t(32959),g=t(16336),j=t(44900),y=t(88257),b=t(32996),v=t(34219),S=t(33847),k=t(40250),w=t(66463),C=t(52338),N=t(86269),E=t(83738),P=t(100),I=t(65822),R=t(22563),_=t(10539);function O(){let e=(0,i._)(["\n  query SingleBackfillQuery($backfillId: String!) {\n    partitionBackfillOrError(backfillId: $backfillId) {\n      ... on PartitionBackfill {\n        id\n        cancelableRuns {\n          id\n          runId\n          status\n        }\n      }\n    }\n  }\n"]);return O=function(){return e},e}let L=e=>null===e.backfill.numPartitions||null===e.backfill.partitionNames||e.backfill.isAssetBackfill?(0,r.jsx)(B,{...e,hasCancelableRuns:!1,statusQueryResult:null}):(0,r.jsx)(F,{backfillId:e.backfill.id,children:n=>(0,r.jsx)(B,{...e,...n})}),F=e=>{let{backfillId:n}=e,t=(0,o.t)(J,{variables:{backfillId:n},notifyOnNetworkStatusChange:!0});(0,v.Hu)(t[1],"SingleBackfillQuery");let[i,r]=t;(0,E.v5)(i),(0,g.C4)(r,g.dT);let{data:s}=r,{hasCancelableRuns:l}=p.useMemo(()=>(null==s?void 0:s.partitionBackfillOrError.__typename)==="PartitionBackfill"&&"partitionBackfill"in s.partitionBackfillOrError?{hasCancelableRuns:s.partitionBackfillOrError.cancelableRuns.length>0}:{hasCancelableRuns:!1},[s]);return e.children({hasCancelableRuns:l,statusQueryResult:r})},B=e=>{let{backfill:n,allPartitions:t,showBackfillTarget:i,onShowPartitionsRequested:o,refetch:s,hasCancelableRuns:c,statusQueryResult:d}=e,u=n.partitionSet?(0,I.kQ)(n.partitionSet.repositoryOrigin.repositoryName,n.partitionSet.repositoryOrigin.repositoryLocationName):null;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{style:{width:120},children:(0,r.jsx)(a.fv,{children:(0,r.jsx)(h.rU,{to:n.isAssetBackfill?"/overview/backfills/".concat(n.id):(0,C.it)([{token:"tag",value:"dagster/backfill=".concat(n.id)}]),children:n.id})})}),(0,r.jsx)("td",{style:{width:220},children:n.timestamp?(0,r.jsx)(N.v,{timestamp:n.timestamp}):"-"}),i?(0,r.jsx)("td",{style:{width:"20%"},children:(0,r.jsx)(A,{backfill:n,repoAddress:u})}):null,(0,r.jsx)("td",{style:{width:t?300:140},children:(0,r.jsx)(T,{backfill:n,allPartitions:t,onExpand:()=>o(n)})}),(0,r.jsx)("td",{style:{width:160},children:(0,r.jsx)(w.f,{tags:n.tags,repoAddress:u})}),(0,r.jsx)("td",{style:{width:140},children:(null==d?void 0:d.loading)?(0,r.jsx)("div",{style:{color:l.$()},children:"Loading"}):(0,r.jsx)(f.w,{backfill:n})}),(0,r.jsx)("td",{children:(0,r.jsx)(x.WH,{backfill:n,canCancelRuns:(0,x.qG)(n,c),refetch:s})})]})},A=e=>{let{backfill:n,repoAddress:t}=e,i=(0,P.Ux)(t),{assetSelection:o,partitionSet:s,partitionSetName:a}=n,u=(0,j.pv)(a||"");return(0,r.jsxs)(c.x,{flex:{direction:"column",gap:8},children:[u?null:s&&i?(0,r.jsx)(h.rU,{style:{fontWeight:500},to:(0,_.jT)({repoName:s.repositoryOrigin.repositoryName,repoLocation:s.repositoryOrigin.repositoryLocationName,pipelineName:s.pipelineName,isJob:(0,P.E8)(i,s.pipelineName),path:"/partitions?partitionSet=".concat(encodeURIComponent(s.name))}),children:s.name}):a?(0,r.jsx)("span",{style:{fontWeight:500},children:a}):null,(0,r.jsxs)(c.x,{flex:{direction:"column",gap:4},style:{fontSize:"12px"},children:[t?(0,r.jsxs)(c.x,{flex:{direction:"row",gap:8,alignItems:"center"},style:{fontSize:"12px"},children:[(0,r.jsx)(d.JO,{name:"repo",color:l.$()}),(0,r.jsx)(h.rU,{to:(0,_.$U)(t),children:(0,R.Uz)(t)})]}):void 0,(null==o?void 0:o.length)?(0,r.jsx)(k.h,{assetKeys:o,dialogTitle:"Assets in backfill"}):s&&i?(0,r.jsx)(S.h,{showIcon:!0,size:"small",pipelineName:s.pipelineName,pipelineHrefContext:{name:s.repositoryOrigin.repositoryName,location:s.repositoryOrigin.repositoryLocationName},isJob:(0,P.E8)(i,s.pipelineName)}):null]})]})},T=e=>{let{allPartitions:n,backfill:t,onExpand:i}=e,{partitionNames:o,numPartitions:s}=t;if(null===s)return(0,r.jsx)("span",{});let l="".concat(s.toLocaleString()," ").concat(1===s?"partition":"partitions");return(0,r.jsxs)(c.x,{flex:{direction:"column",gap:8},children:[(0,r.jsx)("div",{children:o?(0,r.jsx)(M,{onClick:i,children:(0,r.jsx)(u.V,{intent:"primary",interactive:!0,children:l})}):(0,r.jsx)(u.V,{intent:"primary",children:l})}),n&&o&&(0,r.jsx)(D,{all:n,requested:o})]})},D=e=>{let{all:n,requested:t}=e,i=p.useMemo(()=>({runStatusForPartitionKey:e=>t&&t.includes(e)?y.VOA.QUEUED:y.VOA.NOT_STARTED}),[t]);return(0,r.jsx)(b.b,{small:!0,hideStatusTooltip:!0,partitionNames:n,health:i})},M=m.ZP.button.withConfig({componentId:"sc-fcb8ff71-0"})(["border:none;background:none;cursor:pointer;padding:0;margin:0;:focus{outline:none;}"]),J=(0,s.Ps)(O())},32959:function(e,n,t){t.d(n,{w:function(){return d}});var i=t(52322),r=t(14934),o=t(43212),s=t(35505),l=t(8068),a=t(23399),c=t(88257);let d=e=>{let{backfill:n}=e,{status:t,error:s}=n;function d(e){return(0,i.jsx)(r.x,{margin:{bottom:12},children:(0,i.jsx)(u,{onClick:()=>s&&(0,l._K)({title:"Error",body:(0,i.jsx)(a.T9,{error:s})}),children:(0,i.jsx)(o.V,{intent:"danger",children:e})})})}switch(t){case c.Jv3.REQUESTED:return(0,i.jsx)(o.V,{children:"In progress"});case c.Jv3.CANCELING:return d("Canceling");case c.Jv3.CANCELED:return d("Canceled");case c.Jv3.FAILED:return d("Failed");case c.Jv3.COMPLETED:return(0,i.jsx)(o.V,{intent:"success",children:"Completed"});default:return(0,i.jsx)(o.V,{children:t})}},u=s.ZP.button.withConfig({componentId:"sc-b7ae553d-0"})(["border:none;background:none;cursor:pointer;padding:0;margin:0;:focus{outline:none;}"])},90731:function(e,n,t){t.d(n,{b:function(){return v},G:function(){return b}});var i=t(73235),r=t(52322),o=t(89130),s=t(1747),l=t(2784),a=t(84927),c=t(92506),d=t(74188),u=t(38491),p=t(90483),h=t(81732);let m=new Intl.Collator(navigator.language,{sensitivity:"base",numeric:!0}),x=e=>{let{backfill:n,onClose:t}=e;return(0,r.jsxs)(c.Vq,{isOpen:!!n,title:(0,r.jsxs)("span",{children:["Partitions requested for backfill:"," ",(0,r.jsx)("span",{style:{fontSize:"16px",fontFamily:d.b.monospace},children:null==n?void 0:n.id})]}),onClose:t,children:[(0,r.jsx)(f,{partitionNames:(null==n?void 0:n.partitionNames)||[]}),(0,r.jsx)(c.cN,{topBorder:!0,children:(0,r.jsx)(u.zx,{onClick:t,children:"Done"})})]})},f=e=>{let{partitionNames:n}=e,t=(0,l.useMemo)(()=>[...n||[]].sort((e,n)=>m.compare(e,n)),[n]);return(0,r.jsx)("div",{style:{height:"340px",overflow:"hidden"},children:(0,r.jsx)(h.Y,{items:t,renderItem:e=>(0,r.jsx)("div",{children:(0,r.jsx)(p.rd,{text:e})},e)})})};var g=t(94655),j=t(78491);function y(){let e=(0,i._)(["\n  fragment BackfillTableFragment on PartitionBackfill {\n    id\n    status\n    isAssetBackfill\n    isValidSerialization\n    partitionNames\n    numPartitions\n    timestamp\n    partitionSetName\n    partitionSet {\n      id\n      ...PartitionSetForBackfillTable\n    }\n    assetSelection {\n      path\n    }\n    tags {\n      key\n      value\n    }\n    error {\n      ...PythonErrorFragment\n    }\n    ...BackfillActionsBackfillFragment\n  }\n\n  fragment PartitionSetForBackfillTable on PartitionSet {\n    id\n    name\n    mode\n    pipelineName\n    repositoryOrigin {\n      id\n      repositoryName\n      repositoryLocationName\n    }\n  }\n\n  ","\n  ","\n"]);return y=function(){return e},e}let b=e=>{let{showBackfillTarget:n=!0,allPartitions:t,backfills:i,refetch:o}=e,[a,c]=(0,l.useState)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.i,{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"Backfill ID"}),(0,r.jsx)("th",{children:"Created"}),n?(0,r.jsx)("th",{children:"Backfill target"}):null,(0,r.jsx)("th",{children:"Requested"}),(0,r.jsx)("th",{children:"Launched by"}),(0,r.jsx)("th",{children:"Backfill status"}),(0,r.jsx)("th",{style:{width:80}})]})}),(0,r.jsx)("tbody",{children:i.map(e=>(0,r.jsx)(g.FW,{showBackfillTarget:n,backfill:e,allPartitions:t,onShowPartitionsRequested:c,refetch:o},e.id))})]}),(0,r.jsx)(x,{backfill:a,onClose:()=>c(void 0)})]})},v=(0,o.Ps)(y(),j.B,a.V2)},71291:function(e,n,t){t.d(n,{ac:function(){return $},ux:function(){return q},Rc:function(){return J}});var i=t(73235),r=t(52322),o=t(24432),s=t(89130),l=t(60129),a=t(92506),c=t(14934),d=t(38491),u=t(53664),p=t(21993),h=t(39013),m=t(55010),x=t(60603),f=t(2784),g=t(35505),j=t(79106),y=t(37483),b=t(78491),v=t(34219),S=t(33298),k=t(30916),w=t(43984);function C(){let e=(0,i._)(["\n  query PartitionRunListQuery($filter: RunsFilter!) {\n    pipelineRunsOrError(filter: $filter, limit: 500) {\n      ... on PipelineRuns {\n        results {\n          ...RunTableRunFragment\n          id\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return C=function(){return e},e}let N=e=>{let n=(0,o.a)(E,{variables:{filter:{pipelineName:e.pipelineName,tags:[{key:w.H.Partition,value:e.partitionName}]}}});(0,v.Hu)(n,"PartitionRunListQuery");let{data:t,loading:i}=n;return i||!t?(0,r.jsx)(j.$,{purpose:"section"}):"Runs"!==t.pipelineRunsOrError.__typename?(0,r.jsx)(y.t,{icon:"error",title:"Query Error",description:t.pipelineRunsOrError.message}):(0,r.jsx)("div",{children:(0,r.jsx)(S.A,{runs:t.pipelineRunsOrError.results})})},E=(0,s.Ps)(C(),k.Z,b.B);var P=t(95590),I=t(15365),R=t(44900),_=t(65470),O=t(65152),L=t(27052),F=t(77432),B=t(88257),A=t(33182),T=t(43),D=t(20718);function M(){let e=(0,i._)(["\n  query PartitionStepStatusPipelineQuery($pipelineSelector: PipelineSelector) {\n    pipelineSnapshotOrError(activePipelineSelector: $pipelineSelector) {\n      ... on PipelineSnapshot {\n        id\n        name\n        solidHandles {\n          ...PartitionMatrixSolidHandleFragment\n        }\n      }\n    }\n  }\n\n  ","\n"]);return M=function(){return e},e}let J=e=>Math.ceil(e/P.Bj)-3,U=e=>{let[n,t]=[Date.now()/1e3,1];for(let i of e)for(let e of i.steps)0!==e.unix&&([n,t]=[Math.min(n,e.unix),Math.max(t,e.unix)]);return[n,t]},$=f.memo(e=>{let{assetHealth:n,rangeDimension:t,rangeDimensionIdx:i,assetQueryItems:o,...s}=e,l=(0,f.useMemo)(()=>{let e={};for(let o of n){var r;if((null===(r=o.dimensions[i])||void 0===r?void 0:r.name)!==t.name)continue;let n=o.rangesForSingleDimension(i);e[(0,R.Je)(o.assetKey)]=n}return e},[n,t.name,i]),a=(0,f.useMemo)(()=>(0,F.tc)({nodes:o,mode:L.hS.FLAT}).boxes.filter(e=>!!l[e.node.name]),[o,l]),c=(0,f.useMemo)(()=>({stepRows:a.map(e=>({x:e.x,name:e.node.name,totalFailurePercent:0,finalFailurePercent:0})),partitions:[],partitionColumns:t.partitionKeys.map((e,n)=>({idx:n,name:e,runsLoaded:!0,runs:[],steps:a.map(e=>({name:e.node.name,unix:0,color:z((0,O.h1)(l[e.node.name],n))}))}))}),[a,t.partitionKeys,l]);return(0,r.jsx)(Z,{...s,partitionNames:t.partitionKeys,data:c,showLatestRun:!1})}),z=e=>e.includes(_.yo.MATERIALIZED)&&e.includes(_.yo.MISSING)?"SUCCESS-MISSING":e.includes(_.yo.MATERIALIZED)?"SUCCESS":e.includes(_.yo.FAILED)&&e.includes(_.yo.MISSING)?"FAILURE-MISSING":e.includes(_.yo.FAILED)?"FAILURE":"MISSING",q=f.memo(e=>{var n;let{repoAddress:t,pipelineName:i,partitions:s,partitionNames:l,...a}=e,c={...(0,D.$)(t),pipelineName:i},d=(0,o.a)(G,{variables:{pipelineSelector:c},fetchPolicy:"no-cache"});(0,v.Hu)(d,"PartitionStepStatusPipelineQuery");let u=(null===(n=d.data)||void 0===n?void 0:n.pipelineSnapshotOrError.__typename)==="PipelineSnapshot"&&d.data.pipelineSnapshotOrError.solidHandles,p=(0,I.J2)((0,f.useMemo)(()=>({partitionNames:l,partitions:s,stepQuery:"",solidHandles:u}),[l,s,u]));return p?(0,r.jsx)(Z,{...a,showLatestRun:!0,pipelineName:i,partitionNames:l,data:p}):(0,r.jsx)("span",{})}),Z=f.memo(e=>{let{viewport:n,containerProps:t}=(0,l.S)(),[i,o]=(0,f.useState)(null),[s,h]=(0,f.useState)(null),{setPageSize:m,data:x}=e;(0,f.useEffect)(()=>{n.width&&m(J(n.width))},[n.width,m]);let{stepRows:g,partitionColumns:j}=x,y=e=>{let n={};return e.forEach(e=>n[e.name]=e),g.map(e=>n[e.name])},b=J(n.width),v=Math.max(0,j.length-e.offset-b),S=Math.max(b,j.length-e.offset),k=(0,f.useMemo)(()=>j.slice(v,S),[j,S,v]),[w,C]=(0,f.useMemo)(()=>U(j),[j]),E=(0,f.useMemo)(()=>(0,P.G3)(j.map(e=>e.name)),[j]);return(0,r.jsxs)(K,{children:[(0,r.jsxs)(a.Vq,{isOpen:!!s,onClose:()=>h(null),style:{width:"90vw"},title:s?"".concat(s.partitionName," runs"):"",children:[(0,r.jsx)(c.x,{padding:{bottom:12},children:s&&(0,r.jsx)(N,{pipelineName:e.pipelineName,partitionName:s.partitionName})}),(0,r.jsx)(a.cN,{children:(0,r.jsx)(d.zx,{intent:"primary",autoFocus:!0,onClick:()=>h(null),children:"OK"})})]}),(0,r.jsxs)("div",{style:{position:"relative",display:"flex"},children:[(0,r.jsx)(P.NF,{floating:e.offset+b<e.partitionNames.length,children:(0,r.jsxs)(P.C4,{disabled:!0,style:{flex:1,flexShrink:1,overflow:"hidden"},children:[(0,r.jsx)(P.eh,{style:{height:E}}),e.showLatestRun&&(0,r.jsx)(P.p$,{style:{paddingLeft:24},children:"Last Run"}),(0,r.jsx)(V,{}),g.map(e=>(0,r.jsx)(P.p$,{style:{paddingLeft:8+e.x,paddingRight:8},"data-tooltip":e.name,hovered:e.name===(null==i?void 0:i.stepName),children:(0,r.jsx)(u.g,{text:e.name})},e.name))]})}),e.offset+b<e.partitionNames.length?(0,r.jsx)(H,{$direction:"left",onClick:()=>e.setOffset(Math.max(0,Math.min(e.offset+b-1,e.partitionNames.length-b))),children:(0,r.jsx)(p.JO,{name:"chevron_left"})}):null,(0,r.jsx)("div",{style:{flex:1,overflow:"hidden",position:"relative"},...t,children:(0,r.jsx)("div",{style:{width:j.length*P.Bj,position:"absolute",height:"100%",right:0,zIndex:1},children:k.map((n,t)=>(0,r.jsxs)(P.C4,{style:{zIndex:k.length-t,width:P.Bj,position:"absolute",right:(b-t)*P.Bj+20},children:[(0,r.jsx)(P.kD,{$height:E,label:n.name}),e.showLatestRun&&(0,r.jsx)(P.p$,{style:{textAlign:"center"},children:(0,r.jsx)(W,{runs:n.runs,runsLoaded:n.runsLoaded,minUnix:w,maxUnix:C,hovered:i,setHovered:o,setFocused:h,partitionName:n.name},"".concat(n.name,":__full_status"))}),(0,r.jsx)(V,{}),y(n.steps).map(e=>(0,r.jsx)(W,{step:e,runs:n.runs,runsLoaded:n.runsLoaded,minUnix:w,maxUnix:C,hovered:i,setHovered:o,setFocused:h,partitionName:n.name},e.name))]},n.name))})}),e.offset>0?(0,r.jsx)(H,{$direction:"right",onClick:()=>e.setOffset(Math.max(0,e.offset-b)),children:(0,r.jsx)(p.JO,{name:"chevron_right"})}):null]})]})}),H=g.ZP.div.withConfig({componentId:"sc-88170e7a-0"})(["width:30px;position:absolute;border:1px solid ",";border-radius:3px;display:flex;justify-content:center;align-items:center;top:calc(50% - 15px);bottom:calc(50% - 15px);"," background:",";z-index:10;justify-content:center;align-items:center;cursor:pointer;display:flex;&:hover{background:",";}"],h.wL(),e=>{let{$direction:n}=e;return"left"===n?"left: 315px;":"right: 0;"},h.v8(),h.Z$()),K=g.ZP.div.withConfig({componentId:"sc-88170e7a-1"})(["display:block;"]),V=g.ZP.div.withConfig({componentId:"sc-88170e7a-2"})(["height:1px;width:100%;margin-top:5px;border-top:1px solid ",";"],h.wL()),G=(0,s.Ps)(M(),I.Tg),Q=JSON.stringify({top:20,left:10}),W=f.memo(e=>{let n,{step:t,runs:i,runsLoaded:o,hovered:s,setHovered:l,setFocused:a,partitionName:c}=e,[d,u]=(0,f.useState)(!1);if(o){if(t)n=t.color.toLowerCase();else if(0===i.length)n="empty";else{var p;let e=null===(p=[...i].reverse().find(e=>e.status!==B.VOA.CANCELED))||void 0===p?void 0:p.status;n=e?e.toLowerCase():"empty"}}else n="loading";let h=(0,r.jsx)("div",{className:"square ".concat(n),onMouseEnter:()=>l({stepName:null==t?void 0:t.name,partitionName:c}),onMouseLeave:()=>l(null),"data-tooltip":o&&!t?1===i.length?"1 run":"".concat(i.length," runs"):void 0,"data-tooltip-style":Q});return d||i.length&&(null==s?void 0:s.stepName)===(null==t?void 0:t.name)&&(null==s?void 0:s.partitionName)===c?(0,r.jsx)(m.J,{interactionKind:"click",placement:"bottom-start",onOpening:()=>u(!0),onClosed:()=>u(!1),content:(0,r.jsxs)(x.v2,{children:[(0,r.jsx)(T.U,{icon:"open_in_new",text:"Show logs from last run",to:(0,A.tA)(i[i.length-1],{stepKey:t?t.name:null})}),(0,r.jsx)(x.sN,{icon:"settings_backup_restore",text:"View runs (".concat(i.length,")"),onClick:()=>a({stepName:null==t?void 0:t.name,partitionName:c})})]}),children:h}):h})},95590:function(e,n,t){t.d(n,{AQ:function(){return f},Bj:function(){return s},C4:function(){return d},G3:function(){return h},NF:function(){return g},eh:function(){return p},kD:function(){return m},p$:function(){return u}});var i=t(52322),r=t(39013),o=t(35505);let s=32,l={SUCCESS:r.fA(),SUCCESS_SKIPPED:r.Lv(),FAILURE:r.FY(),FAILURE_SKIPPED:r.MP(),SKIPPED:r.qr(),IN_PROGRESS:r.L$()},a=e=>"linear-gradient(to left, ".concat(e," 0%, ").concat(e," 100%)"),c=e=>e.map(a).join(","),d=o.ZP.div.withConfig({componentId:"sc-519f33a1-0"})(["display:flex;flex-direction:column;flex-shrink:0;line-height:0;"," "," "," "," .cell{height:","px;display:inline-block;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-size:12px;padding:2px;box-sizing:border-box;line-height:initial;}.square{width:20px;height:20px;margin:6px;display:inline-block;&:hover:not(.empty):before{box-shadow:"," 0 0 0 3px;}&:before{content:' ';background:",";border-radius:10px;display:inline-block;width:20px;height:20px;}&.loading{&:before{background:radial-gradient( "," 0%,"," 45%,"," 60% );}}&.success{&:before{background:",";}}&.failure{&:before{background:",";}}&.success-missing{&:before{background:",";}}&.failure-missing{&:before{background:",";}}&.failure-blank{&:before{background:",";}}&.skipped{&:before{background:",";}}&.started,&.starting,&.canceling{&:before{background:",";}}}"],e=>{let{disabled:n,focused:t,multiselectFocused:i,hovered:o}=e;return!n&&!t&&!i&&"&".concat(o?"":":hover"," {\n      background: ").concat(r.Z$(),";\n      cursor: default;\n      ").concat(x," {\n        background: ").concat(r.Z$(),";\n        .tilted {\n          background: ").concat(r.gJ(),";\n        }\n      }\n      .square {\n        filter: brightness(95%);\n      }\n    }")},e=>{let{disabled:n}=e;return n&&"\n      ".concat(x," {\n        color: ").concat(r.$(),"\n      }\n    ")},e=>{let{focused:n}=e;return n&&"background: ".concat(r.L$(),";\n    ").concat(u," {\n      color: ").concat(r.KH(),";\n    }\n    ").concat(x," {\n      background: ").concat(r.Bj(),";\n      color: ").concat(r.KH(),";\n      .tilted {\n        background: ").concat(r.L$(),";\n      }\n    }\n  }")},e=>{let{multiselectFocused:n}=e;return n&&"background: ".concat(r.U9(),";\n    ").concat(u," {\n      color: ").concat(r.KH(),";\n    }\n    ").concat(x," {\n      background: ").concat(r.Bj(),";\n      color: ").concat(r.KH(),";\n      .tilted {\n        background: ").concat(r.U9(),";\n      }\n    }\n  }")},s,r.L$(),r.md(),r.wc(),r.wc(),r.Yj(),l.SUCCESS,l.FAILURE,l.SUCCESS_SKIPPED,l.FAILURE_SKIPPED,l.FAILURE_SKIPPED,l.SKIPPED,l.IN_PROGRESS),u=o.ZP.div.withConfig({componentId:"sc-519f33a1-1"})(["height:","px;line-height:","px;font-size:13px;overflow:hidden;text-overflow:ellipsis;position:relative;background:",";"],s,s,e=>{let{hovered:n}=e;return c([n?r.gJ():"transparent"])}),p=o.ZP.div.withConfig({componentId:"sc-519f33a1-2"})(["position:relative;height:70px;padding:4px;padding-bottom:0;min-width:15px;align-items:flex-end;display:flex;"]);function h(e){let n=0;for(let t of e)n=Math.max(n,t.length);return(n>10?4.9*n:55)+15}let m=e=>{let{label:n,$height:t}=e;return(0,i.jsx)(x,{style:{height:t-15},children:(0,i.jsx)("div",{className:"tilted",children:n})})},x=o.ZP.div.withConfig({componentId:"sc-519f33a1-3"})(["position:relative;height:unset;padding:4px;padding-bottom:0;min-width:15px;margin-bottom:","px;align-items:end;display:flex;line-height:normal;& > div.tilted{font-size:12px;white-space:nowrap;position:absolute;bottom:-20px;left:0;padding:2px;padding-right:4px;padding-left:0;transform:rotate(-","deg);transform-origin:top left;}"],15,41),f=330,g=o.ZP.div.withConfig({componentId:"sc-519f33a1-4"})(["display:flex;border-right:1px solid ",";padding-bottom:16px;width:","px;z-index:1;",";"],r.im(),f,e=>{let{floating:n}=e;return n?"box-shadow: 1px 0 4px rgba(0, 0, 0, 0.15)":""})},15365:function(e,n,t){t.d(n,{J2:function(){return j},Tg:function(){return b},iv:function(){return y}});var i=t(73235),r=t(89130),o=t(98832),s=t(13549),l=t(77432),a=t(88257),c=t(58233),d=t(67126),u=t(17298);function p(){let e=(0,i._)(["\n  fragment PartitionMatrixStepRunFragment on Run {\n    id\n    status\n    startTime\n    endTime\n    stepStats {\n      stepKey\n      startTime\n      endTime\n      status\n    }\n    tags {\n      key\n      value\n    }\n  }\n"]);return p=function(){return e},e}function h(){let e=(0,i._)(["\n  fragment PartitionMatrixSolidHandleFragment on SolidHandle {\n    handleID\n    solid {\n      name\n      definition {\n        name\n      }\n      inputs {\n        dependsOn {\n          solid {\n            name\n          }\n        }\n      }\n      outputs {\n        dependedBy {\n          solid {\n            name\n          }\n        }\n      }\n    }\n    ...GraphExplorerSolidHandleFragment\n  }\n\n  ","\n"]);return h=function(){return e},e}let m=new Set([a.SGm.IN_PROGRESS,a.SGm.SKIPPED]);function x(e){return e.startTime||0}function f(e,n){return x(e)-x(n)}function g(e,n){let t=RegExp(e+"\\[.*\\]");return n===e||n==="".concat(e,".compute")||n.match(t)}let j=e=>{let{solidHandles:n,stepQuery:t,partitionNames:i,partitions:r,options:a}=e;return(0,c.l)(()=>{let e=n?(0,d.i)(n).map(e=>e.solid):[],c=(0,o.V)(e,t),u=(0,l.tc)({nodes:c.all,mode:s.hS.FLAT}),p={};return r.forEach(e=>{e.runs.sort(f),p[e.name]=e}),function(e,n,t,i){let r=n.map((n,i)=>{let r=t[n]||{name:n,runsLoaded:!1,runs:[]},o=e.boxes.map(e=>{var n,t;let i,{node:o}=e,s={name:o.name,color:"MISSING",unix:0};if(!r.runs.length)return s;let l=r.runs[r.runs.length-1],a=null===(n=l.stepStats.find(e=>g(o.name,e.stepKey)))||void 0===n?void 0:n.status;if(r.runs.length>1&&(!a||m.has(a))){let e=r.runs.length-2;for(;e>=0&&!i;){let n=null===(t=r.runs[e].stepStats.find(e=>g(o.name,e.stepKey)))||void 0===t?void 0:t.status;if(n&&!m.has(n)){i=n;break}e--}}if(!a&&!i)return s;let c=!a||m.has(a)?"".concat(i,"-MISSING"):a;return{name:o.name,unix:x(l),color:c}});return{...r,steps:o,idx:i}}),o=r.filter(e=>e.runs.length>0).length,s=e.boxes.map((e,n)=>{let t=r.filter(e=>e.steps[n].color.includes("FAILURE")),i=r.filter(e=>e.steps[n].color.endsWith("FAILURE"));return{x:e.x,name:e.node.name,totalFailurePercent:o?Math.round(t.length/o*100):0,finalFailurePercent:o?Math.round(i.length/o*100):0}});if(null==i?void 0:i.showFailuresAndGapsOnly){for(let e=s.length-1;e>=0;e--)0===s[e].finalFailurePercent&&(s.splice(e,1),r.forEach(n=>n.steps.splice(e,1)));for(let e=r.length-1;e>=0;e--)(0===r[e].runs.length||r[e].steps.every(e=>e.color.includes("SUCCESS")))&&r.splice(e,1)}return{stepRows:s,partitionColumns:r}}(u,i,p,a)},[n,t,r,i,a],1e3)},y=(0,r.Ps)(p()),b=(0,r.Ps)(h(),u.Q)},9875:function(e,n,t){t.d(n,{T:function(){return h}});var i=t(73235),r=t(56675),o=t(89130),s=t(2784),l=t(15365),a=t(78491),c=t(88257),d=t(43984);function u(){let e=(0,i._)(["\n  query PartitionStepLoaderQuery($filter: RunsFilter!, $cursor: String, $limit: Int) {\n    pipelineRunsOrError(filter: $filter, cursor: $cursor, limit: $limit) {\n      ... on Runs {\n        results {\n          id\n          ...PartitionMatrixStepRunFragment\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return u=function(){return e},e}let p={runs:[],partitionNames:[],loading:!1,loadingCursorIdx:0};function h(e){let{partitionSetName:n,partitionTagName:t,partitionNames:i,pageSize:o,runsFilter:l,jobName:a,repositorySelector:u,offset:h,skipQuery:x}=e,f=(0,r.x)(),g=(0,s.useRef)(0),[j,y]=(0,s.useState)(p),b=(0,s.useMemo)(()=>JSON.stringify([...l.map(e=>{let[n,t]=e.value.split("=");return{key:n,value:t}}),{key:d.H.RepositoryLabelTag,value:"".concat(u.repositoryName,"@").concat(u.repositoryLocationName)}]),[u.repositoryLocationName,u.repositoryName,l]),v=(0,s.useMemo)(()=>new Set(i),[i]);return(0,s.useEffect)(()=>{let e=g.current+1;g.current=e;let r=JSON.parse(b);y(e=>({...e,runs:[],loading:!0}));let s=async()=>{if(g.current!==e)return;let s=i.length-(h||0),l=Math.max(0,s-o);for(y(e=>({...e,partitionNames:i,loadingCursorIdx:s}));s>l;){let o=Math.max(s-5,0),l=i.slice(o,s),c=await Promise.all(l.map(e=>{let i={key:d.H.PartitionSet,value:n},o={key:t,value:e};return m(f,{limit:1e3,filter:a?{pipelineName:a,tags:[...r,o]}:{tags:[...r,o,i]}})}));if(g.current!==e)return;s=o,y(e=>({...e,runs:[...e.runs].concat(...c),loading:s>0,loadingCursorIdx:s}))}let u=setInterval(async()=>{if(g.current!==e)return clearInterval(u);y(e=>({...e,loading:!0}));let i=await m(f,{limit:10,filter:{tags:[...r,{key:d.H.PartitionSet,value:n}]}}),o=await m(f,{filter:{statuses:[c.VOA.STARTED],tags:[...r,{key:d.H.PartitionSet,value:n}]}});if(g.current!==e)return clearInterval(u);let s=[...o,...i].filter(e=>e.tags.find(e=>e.key===t&&v.has(e.value)));y(e=>{let n=e.runs.filter(e=>!s.some(n=>n.id===e.id)).concat(s);return{...e,loading:!1,runs:n}})},1e4)};return x||s(),()=>{g.current+=1}},[o,f,n,t,b,a,h,i,x,v]),(0,s.useMemo)(()=>(function(e,n){let t=[],i={};return e.partitionNames.forEach((n,r)=>{i[n]={name:n,runsLoaded:r>=e.loadingCursorIdx,runs:[]},t.push(i[n])}),e.runs.forEach(e=>{var t,r;null===(r=i[(null===(t=e.tags.find(e=>e.key===n))||void 0===t?void 0:t.value)||""])||void 0===r||r.runs.push(e)}),t})(j,t),[j,t])}async function m(e,n){let t=await e.query({fetchPolicy:"no-cache",query:x,variables:n});return"Runs"===t.data.pipelineRunsOrError.__typename&&t.data.pipelineRunsOrError.results||[]}let x=(0,o.Ps)(u(),l.iv,a.B)},70468:function(e,n,t){t.d(n,{_:function(){return y}});var i=t(52322),r=t(55010),o=t(60603),s=t(38491),l=t(21993),a=t(2784),c=t(33379),d=t(25212),u=t(34147),p=t(39013),h=t(92506),m=t(99417),x=t(54724),f=t(94062);let g=e=>{let{openWithIntent:n,onClose:t,onComplete:r,schedules:o}=e,g=o.length,[j,y]=(0,x.s)();(0,a.useEffect)(()=>{"not-open"===n&&y({type:"reset"})},[n,y]);let[b]=(0,c.D)(m.Wz),[v]=(0,c.D)(m.d0),S=async e=>{let{repoAddress:n,scheduleName:t}=e,i={scheduleSelector:{repositoryLocationName:n.location,repositoryName:n.name,scheduleName:t}},{data:r}=await b({variables:i});switch(null==r?void 0:r.startSchedule.__typename){case"ScheduleStateResult":y({type:"update-success"});return;case"UnauthorizedError":case"PythonError":y({type:"update-error",name:t,error:r.startSchedule.message})}},k=async e=>{let{scheduleName:n,scheduleState:t}=e,i={id:t.id},{data:r}=await v({variables:i});switch(null==r?void 0:r.stopRunningSchedule.__typename){case"ScheduleStateResult":y({type:"update-success"});return;case"UnauthorizedError":case"PythonError":y({type:"update-error",name:n,error:r.stopRunningSchedule.message})}},w=async()=>{if("not-open"!==n){for(let e of(y({type:"start"}),o))"start"===n?await S(e):await k(e);y({type:"complete"}),r()}},C="updating"!==j.step;return(0,i.jsxs)(h.Vq,{isOpen:"not-open"!==n,title:"start"===n?"Start schedules":"Stop schedules",canEscapeKeyClose:C,canOutsideClickClose:C,onClose:t,children:[(0,i.jsx)(h.a7,{children:(0,i.jsxs)(u.Z,{direction:"column",spacing:24,children:[(()=>{if("not-open"===n)return null;switch(j.step){case"initial":if("stop"===n)return(0,i.jsx)("div",{children:"".concat(g," ").concat(1===g?"schedule":"schedules"," will be stopped. Do you want to continue?")});return(0,i.jsx)("div",{children:"".concat(g," ").concat(1===g?"schedule":"schedules"," will be started. Do you want to continue?")});case"updating":case"completed":let e=g>0?j.completion.completed/g:1;return(0,i.jsxs)(u.Z,{direction:"column",spacing:8,children:[(0,i.jsx)(d.ko,{intent:"primary",value:Math.max(.1,e),animate:e<1}),"updating"===j.step?(0,i.jsx)(f.c,{message:"Schedules are being updated, please do not navigate away yet."}):null]});default:return null}})(),(()=>{if("not-open"===n||"initial"===j.step)return null;if("updating"===j.step)return(0,i.jsx)("div",{children:"Please do not close the window or navigate away while schedules are being updated."});let e=j.completion.errors,t=Object.keys(e).length,r=j.completion.completed-t;return(0,i.jsxs)(u.Z,{direction:"column",spacing:8,children:[r?(0,i.jsxs)(u.Z,{direction:"row",spacing:8,alignItems:"flex-start",children:[(0,i.jsx)(l.JO,{name:"check_circle",color:p.fA()}),(0,i.jsx)("div",{children:"start"===n?"Successfully started ".concat(1===r?"1 schedule":"".concat(r," schedules"),"."):"Successfully stopped ".concat(1===r?"1 schedule":"".concat(r," schedules"),".")})]}):null,t?(0,i.jsxs)(u.Z,{direction:"column",spacing:8,children:[(0,i.jsxs)(u.Z,{direction:"row",spacing:8,alignItems:"flex-start",children:[(0,i.jsx)(l.JO,{name:"warning",color:p.qr()}),(0,i.jsx)("div",{children:"start"===n?"Could not start ".concat(1===t?"1 schedule":"".concat(t," schedules"),"."):"Could not stop ".concat(1===t?"1 schedule":"".concat(t," schedules"),".")})]}),(0,i.jsx)("ul",{children:Object.keys(e).map(n=>(0,i.jsx)("li",{children:(0,i.jsxs)(u.Z,{direction:"row",spacing:8,children:[(0,i.jsxs)("strong",{children:[n,":"]}),e[n]?(0,i.jsx)("div",{children:e[n]}):null]})},n))})]}):null]})})()]})}),(0,i.jsx)(h.cN,{children:(()=>{if("not-open"===n)return null;switch(j.step){case"initial":return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.zx,{intent:"none",onClick:t,children:"Cancel"}),(0,i.jsx)(s.zx,{intent:"primary",onClick:w,children:"start"===n?"Start ".concat(1===g?"1 schedule":"".concat(g," schedules")):"Stop ".concat(1===g?"1 schedule":"".concat(g," schedules"))})]});case"updating":return(0,i.jsx)(s.zx,{intent:"primary",disabled:!0,children:"start"===n?"Starting ".concat(1===g?"1 schedule":"".concat(g," schedules")):"Stopping ".concat(1===g?"1 schedule":"".concat(g," schedules"))});case"completed":return(0,i.jsx)(s.zx,{intent:"primary",onClick:t,children:"Done"})}})()})]})};var j=t(69557);let y=e=>{let{schedules:n,onDone:t}=e,c=n.length,[d,u]=(0,a.useState)("not-open"),{anyOff:p,anyOn:h}=(0,a.useMemo)(()=>(0,j.H)(n.map(e=>{let{scheduleState:n}=e;return n})),[n]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.J,{content:(0,i.jsxs)(o.v2,{children:[(0,i.jsx)(o.sN,{text:"Start ".concat(1===c?"1 schedule":"".concat(c," schedules")),disabled:!p,"aria-disabled":!p,icon:"toggle_on",onClick:()=>{u("start")}}),(0,i.jsx)(o.sN,{text:"Stop ".concat(1===c?"1 schedule":"".concat(c," schedules")),disabled:!h,"aria-disabled":!h,icon:"toggle_off",onClick:()=>{u("stop")}})]}),placement:"bottom-end",children:(0,i.jsx)(s.zx,{disabled:!c,intent:"primary",rightIcon:(0,i.jsx)(l.JO,{name:"expand_more"}),children:"Actions"})}),(0,i.jsx)(g,{openWithIntent:d,schedules:n,onClose:()=>u("not-open"),onComplete:()=>{t()}})]})}},74050:function(e,n,t){t.d(n,{K:function(){return s}});var i=t(52322),r=t(14934),o=t(16629);t(2784);let s=e=>{let n,{daemonHealth:t,...s}=e;if(t){let e=t.allDaemonStatuses.filter(e=>"SCHEDULER"===e.daemonType);if(e.length>0){let t=e[0];n=t.required&&t.healthy}}return!1===n?(0,i.jsx)(r.x,{...s,children:(0,i.jsx)(o.b,{intent:"warning",title:"The scheduler daemon is not running.",description:(0,i.jsxs)("div",{children:["See the"," ",(0,i.jsx)("a",{href:"https://docs.dagster.io/deployment/dagster-daemon",children:"dagster-daemon documentation"})," ","for more information on how to deploy the dagster-daemon process."]})})}):null}},87209:function(e,n,t){t.d(n,{g:function(){return r}});var i=t(22563);let r=(e,n)=>"".concat((0,i.Uz)(e),"-").concat(n)},64265:function(e,n,t){t.d(n,{b:function(){return y}});var i=t(52322),r=t(55010),o=t(60603),s=t(38491),l=t(21993),a=t(2784),c=t(33379),d=t(25212),u=t(34147),p=t(39013),h=t(92506),m=t(89398),x=t(54724),f=t(94062);let g=e=>{let{openWithIntent:n,onClose:t,onComplete:r,sensors:o}=e,g=o.length,[j,y]=(0,x.s)();(0,a.useEffect)(()=>{"not-open"===n&&y({type:"reset"})},[n,y]);let[b]=(0,c.D)(m.VE),[v]=(0,c.D)(m.Xu),S=async e=>{let{repoAddress:n,sensorName:t}=e,i={sensorSelector:{repositoryLocationName:n.location,repositoryName:n.name,sensorName:t}},{data:r}=await b({variables:i});switch(null==r?void 0:r.startSensor.__typename){case"Sensor":y({type:"update-success"});return;case"SensorNotFoundError":case"UnauthorizedError":case"PythonError":y({type:"update-error",name:t,error:r.startSensor.message})}},k=async e=>{let{sensorName:n,sensorState:t}=e,i={id:t.id},{data:r}=await v({variables:i});switch(null==r?void 0:r.stopSensor.__typename){case"StopSensorMutationResult":y({type:"update-success"});return;case"UnauthorizedError":case"PythonError":y({type:"update-error",name:n,error:r.stopSensor.message})}},w=async()=>{if("not-open"!==n){for(let e of(y({type:"start"}),o))"start"===n?await S(e):await k(e);y({type:"complete"}),r()}},C="updating"!==j.step;return(0,i.jsxs)(h.Vq,{isOpen:"not-open"!==n,title:"start"===n?"Start sensors":"Stop sensors",canEscapeKeyClose:C,canOutsideClickClose:C,onClose:t,children:[(0,i.jsx)(h.a7,{children:(0,i.jsxs)(u.Z,{direction:"column",spacing:24,children:[(()=>{if("not-open"===n)return null;switch(j.step){case"initial":if("stop"===n)return(0,i.jsx)("div",{children:"".concat(g," ").concat(1===g?"sensor":"sensors"," will be stopped. Do you want to continue?")});return(0,i.jsx)("div",{children:"".concat(g," ").concat(1===g?"sensor":"sensors"," will be started. Do you want to continue?")});case"updating":case"completed":let e=g>0?j.completion.completed/g:1;return(0,i.jsxs)(u.Z,{direction:"column",spacing:8,children:[(0,i.jsx)(d.ko,{intent:"primary",value:Math.max(.1,e),animate:e<1}),"updating"===j.step?(0,i.jsx)(f.c,{message:"Sensors are being updated, please do not navigate away yet."}):null]});default:return null}})(),(()=>{if("not-open"===n||"initial"===j.step)return null;if("updating"===j.step)return(0,i.jsx)("div",{children:"Please do not close the window or navigate away while sensors are being updated."});let e=j.completion.errors,t=Object.keys(e).length,r=j.completion.completed-t;return(0,i.jsxs)(u.Z,{direction:"column",spacing:8,children:[r?(0,i.jsxs)(u.Z,{direction:"row",spacing:8,alignItems:"flex-start",children:[(0,i.jsx)(l.JO,{name:"check_circle",color:p.fA()}),(0,i.jsx)("div",{children:"start"===n?"Successfully started ".concat(1===r?"1 sensor":"".concat(r," sensors"),"."):"Successfully stopped ".concat(1===r?"1 sensor":"".concat(r," sensors"),".")})]}):null,t?(0,i.jsxs)(u.Z,{direction:"column",spacing:8,children:[(0,i.jsxs)(u.Z,{direction:"row",spacing:8,alignItems:"flex-start",children:[(0,i.jsx)(l.JO,{name:"warning",color:p.qr()}),(0,i.jsx)("div",{children:"start"===n?"Could not start ".concat(1===t?"1 sensor":"".concat(t," sensors"),":"):"Could not stop ".concat(1===t?"1 sensor":"".concat(t," sensors"),":")})]}),(0,i.jsx)("ul",{style:{margin:"8px 0"},children:Object.keys(e).map(n=>(0,i.jsx)("li",{children:(0,i.jsxs)(u.Z,{direction:"row",spacing:8,children:[(0,i.jsxs)("strong",{children:[n,":"]}),e[n]?(0,i.jsx)("div",{children:e[n]}):null]})},n))})]}):null]})})()]})}),(0,i.jsx)(h.cN,{children:(()=>{if("not-open"===n)return null;switch(j.step){case"initial":return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.zx,{intent:"none",onClick:t,children:"Cancel"}),(0,i.jsx)(s.zx,{intent:"primary",onClick:w,children:"start"===n?"Start ".concat(1===g?"1 sensor":"".concat(g," sensors")):"Stop ".concat(1===g?"1 sensor":"".concat(g," sensors"))})]});case"updating":return(0,i.jsx)(s.zx,{intent:"primary",disabled:!0,children:"start"===n?"Starting ".concat(1===g?"1 sensor":"".concat(g," sensors")):"Stopping ".concat(1===g?"1 sensor":"".concat(g," sensors"))});case"completed":return(0,i.jsx)(s.zx,{intent:"primary",onClick:t,children:"Done"})}})()})]})};var j=t(69557);let y=e=>{let{sensors:n,onDone:t}=e,c=n.length,[d,u]=(0,a.useState)("not-open"),{anyOff:p,anyOn:h}=(0,a.useMemo)(()=>(0,j.H)(n.map(e=>{let{sensorState:n}=e;return n})),[n]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.J,{content:(0,i.jsxs)(o.v2,{children:[(0,i.jsx)(o.sN,{text:"Start ".concat(1===c?"1 sensor":"".concat(c," sensors")),disabled:!p,"aria-disabled":!p,icon:"toggle_on",onClick:()=>{u("start")}}),(0,i.jsx)(o.sN,{text:"Stop ".concat(1===c?"1 sensor":"".concat(c," sensors")),disabled:!h,"aria-disabled":!h,icon:"toggle_off",onClick:()=>{u("stop")}})]}),placement:"bottom-end",children:(0,i.jsx)(s.zx,{disabled:!c,intent:"primary",rightIcon:(0,i.jsx)(l.JO,{name:"expand_more"}),children:"Actions"})}),(0,i.jsx)(g,{openWithIntent:d,sensors:n,onClose:()=>u("not-open"),onComplete:()=>{t()}})]})}},73658:function(e,n,t){t.d(n,{W:function(){return c}});var i=t(52322),r=t(2784);let o=e=>{let[n,t]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let n=setTimeout(()=>t(!0),e);return()=>clearTimeout(n)},[e]),n};var s=t(14934),l=t(35002),a=t(79106);let c=e=>{let{tooltipContent:n}=e;return o(2e3)?(0,i.jsx)(s.x,{margin:{top:1},children:(0,i.jsx)(l.u,{placement:"top",canShow:!!n,content:n||"",children:(0,i.jsx)(a.$,{purpose:"body-text"})})}):null}},85062:function(e,n,t){t.d(n,{Y:function(){return r}});var i=t(39013);let r=t(35505).ZP.div.withConfig({componentId:"sc-1e417a12-0"})(["thead tr{position:sticky;top:","px;background-color:",";z-index:1;}thead tr th{position:relative;}thead tr th::after{content:'';display:block;height:1px;background-color:",";position:absolute;bottom:-1px;left:0;right:0;}"],e=>{let{$top:n=0}=e;return n},i.v8(),i.wL())},63485:function(e,n,t){t.d(n,{I:function(){return z},b:function(){return $}});var i=t(73235),r=t(52322),o=t(3842),s=t(89130),l=t(53664),a=t(14934),c=t(2784),d=t(47933),u=t(35505),p=t(83738),h=t(100),m=t(10539),x=t(16336),f=t(60603),g=t(79106),j=t(55010),y=t(35002),b=t(38491),v=t(21993),S=t(36803),k=t(32177),w=t(51701),C=t(88257),N=t(34219),E=t(83846),P=t(42519),I=t(43);function R(){let e=(0,i._)(["\n  query RunReExecutionQuery($runId: ID!) {\n    pipelineRunOrError(runId: $runId) {\n      ... on Run {\n        id\n        status\n        pipelineName\n        executionPlan {\n          artifactsPersisted\n          ...ExecutionPlanToGraphFragment\n        }\n      }\n    }\n  }\n  ","\n"]);return R=function(){return e},e}let _=e=>{let{job:n,isAssetJob:t,repoAddress:i}=e,s=n.runs.length?n.runs[0]:null,l={pipelineName:n.name,repositoryName:i.name,repositoryLocationName:i.location},a=(0,k.DO)(n.name),d=(0,P.D)(),{permissions:{canLaunchPipelineReexecution:u,canLaunchPipelineExecution:p},disabledReasons:h}=(0,S.xz)(i.location),[x,w]=(0,o.t)(O),{data:R}=w;(0,N.Hu)(w,"RunReExecutionQuery");let _=(0,c.useCallback)(()=>{(null==s?void 0:s.id)&&x({variables:{runId:s.id}})},[s,x]),L=(null==R?void 0:R.pipelineRunOrError.__typename)==="Run"?null==R?void 0:R.pipelineRunOrError:null,F="loading"===t?(0,r.jsx)(f.sN,{icon:"execute",text:"Loading...",disabled:!0}):!0===t?(0,r.jsx)(f.sN,{icon:a.loading?(0,r.jsx)(g.$,{purpose:"caption-text"}):"execute",text:"Launch new run",disabled:!p,onClick:e=>a.onClick(l,e)}):(0,r.jsx)(I.U,{icon:"execute",text:"Launch new run",disabled:!p,to:(0,m.jT)({repoName:i.name,repoLocation:i.location,pipelineName:n.name,isJob:n.isJob,path:"/playground"})}),B=(0,r.jsx)(f.sN,{icon:"replay",text:"Re-execute latest run",onClick:()=>L?d(L,C.hmq.ALL_STEPS):void 0,disabled:!u||!L||!(0,E.EP)(L)}),A=(0,r.jsx)(f.sN,{icon:"sync_problem",text:"Re-execute latest run from failure",onClick:()=>L?d(L,C.hmq.FROM_FAILURE):void 0,disabled:!u||!L||!(0,E.VM)(L)});return(0,r.jsxs)(r.Fragment,{children:[a.launchpadElement,(0,r.jsx)(j.J,{onOpened:()=>_(),content:(0,r.jsxs)(f.v2,{children:[(0,r.jsx)(I.U,{to:(0,m.jT)({repoName:i.name,repoLocation:i.location,pipelineName:n.name,isJob:n.isJob}),icon:"job",text:"View job"}),(0,r.jsx)(I.U,{to:(0,m.jT)({repoName:i.name,repoLocation:i.location,pipelineName:n.name,isJob:n.isJob,path:"/runs"}),icon:"checklist",text:"View all recent runs"}),p?F:(0,r.jsx)(y.u,{content:h.canLaunchPipelineExecution,display:"block",children:F}),u?B:(0,r.jsx)(y.u,{content:h.canLaunchPipelineReexecution,display:"block",children:B}),u?A:(0,r.jsx)(y.u,{content:h.canLaunchPipelineReexecution,display:"block",children:A})]}),position:"bottom-left",children:(0,r.jsx)(b.zx,{icon:(0,r.jsx)(v.JO,{name:"expand_more"})})})]})},O=(0,s.Ps)(R(),w.$);var L=t(60648),F=t(74283),B=t(84046),A=t(33182),T=t(4219),D=t(60918),M=t(17008);function J(){let e=(0,i._)(["\n  query SingleJobQuery($selector: PipelineSelector!) {\n    pipelineOrError(params: $selector) {\n      ... on Pipeline {\n        id\n        name\n        isJob\n        isAssetJob\n        description\n        runs(limit: 5) {\n          id\n          ...RunTimeFragment\n        }\n        schedules {\n          id\n          ...ScheduleSwitchFragment\n        }\n        sensors {\n          id\n          ...SensorSwitchFragment\n        }\n      }\n    }\n  }\n\n  ","\n  ","\n  ","\n"]);return J=function(){return e},e}let U="1.5fr 1fr 180px 96px 80px",$=e=>{let{name:n,isJob:t,repoAddress:i,start:s,height:u}=e,[f,g]=(0,o.t)(H,{variables:{selector:(0,h._T)(i,n)}});(0,N.Hu)(g,"SingleJobQuery"),(0,p.v5)(f),(0,x.C4)(g,x.dT);let{data:j}=g,y=(null==j?void 0:j.pipelineOrError.__typename)==="Pipeline"?null==j?void 0:j.pipelineOrError:void 0,{schedules:b,sensors:v}=(0,c.useMemo)(()=>{if(y){let{schedules:e,sensors:n}=y;return{schedules:e,sensors:n}}return{schedules:[],sensors:[]}},[y]),S=(0,c.useMemo)(()=>{if(y){let{runs:e}=y;if(e.length)return[...e]}return[]},[y]);return(0,r.jsx)(M.X2,{$height:u,$start:s,children:(0,r.jsxs)(q,{border:"bottom",children:[(0,r.jsxs)(M.E5,{children:[(0,r.jsx)("div",{style:{maxWidth:"100%",whiteSpace:"nowrap",fontWeight:500},children:(0,r.jsx)(d.rU,{to:(0,m.$U)(i,"/jobs/".concat(n)),children:(0,r.jsx)(l.g,{text:n})})}),(0,r.jsx)(p.HB,{children:(null==y?void 0:y.description)||""})]}),(0,r.jsx)(M.E5,{children:b.length||v.length?(0,r.jsx)(a.x,{flex:{direction:"column",alignItems:"flex-start",gap:8},children:(0,r.jsx)(Z,{children:(0,r.jsx)(F.I,{schedules:b,sensors:v,repoAddress:i})})}):(0,r.jsx)(p.mq,{queryResult:g})}),(0,r.jsx)(M.E5,{children:S[0]?(0,r.jsx)(L.Z,{run:S[0],showButton:!1,showHover:!0,showSummary:!1,name:n}):(0,r.jsx)(p.mq,{queryResult:g})}),(0,r.jsx)(M.E5,{children:S.length?(0,r.jsx)(a.x,{padding:{top:4},children:(0,r.jsx)(B.JH,{jobName:n,runs:[...S].reverse(),fade:!0})}):(0,r.jsx)(p.mq,{queryResult:g})}),(0,r.jsx)(M.E5,{children:(0,r.jsx)(a.x,{flex:{justifyContent:"flex-end"},style:{marginTop:"-2px"},children:(0,r.jsx)(_,{job:{name:n,isJob:t,runs:S},isAssetJob:y?y.isAssetJob:"loading",repoAddress:i})})})]})})},z=()=>(0,r.jsxs)(M.VJ,{templateColumns:U,sticky:!0,children:[(0,r.jsx)(M.qN,{children:"Name"}),(0,r.jsx)(M.qN,{children:"Schedules/sensors"}),(0,r.jsx)(M.qN,{children:"Latest run"}),(0,r.jsx)(M.qN,{children:"Run history"}),(0,r.jsx)(M.qN,{})]}),q=(0,u.ZP)(a.x).withConfig({componentId:"sc-cd82bd61-0"})(["display:grid;grid-template-columns:",";height:100%;"],U),Z=u.ZP.div.withConfig({componentId:"sc-cd82bd61-1"})(["width:100%;> .bp4-popover2-target{width:100%;}"]),H=(0,s.Ps)(J(),A.$X,T.J,D.U)}}]);
//# sourceMappingURL=6312.5cfb631a5d1cc199.js.map