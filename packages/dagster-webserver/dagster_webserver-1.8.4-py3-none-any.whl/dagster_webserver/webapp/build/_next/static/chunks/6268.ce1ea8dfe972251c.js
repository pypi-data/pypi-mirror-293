(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6268],{96795:function(e,n,r){var t=r(36740)(function(e,n,r){e[r?0:1].push(n)},function(){return[[],[]]});e.exports=t},35232:function(e,n,r){"use strict";r.d(n,{_:function(){return o}});var t=r(73235),u=r(24432),i=r(89130),s=r(34219);function l(){let e=(0,t._)(["\n  query InstanceConfigHasInfo {\n    instance {\n      id\n      hasInfo\n    }\n  }\n"]);return l=function(){return e},e}let o=()=>{var e;let n=(0,u.a)(a);return(0,s.Hu)(n,"InstanceConfigHasInfoQuery"),!!(null===(e=n.data)||void 0===e?void 0:e.instance.hasInfo)},a=(0,i.Ps)(l())},38267:function(e,n,r){"use strict";r.d(n,{Q1:function(){return C},Qf:function(){return b},zc:function(){return j}});var t=r(73235),u=r(52322),i=r(24432),s=r(89130),l=r(38491),o=r(39013),a=r(18149),d=r.n(a),c=r(2784),f=r(7267),h=r(35505),p=r(59351),v=r(52338),m=r(20171),x=r(34219),g=r(88610);function y(){let e=(0,t._)(["\n  query RunTabsCountQuery($queuedFilter: RunsFilter!, $inProgressFilter: RunsFilter!) {\n    queuedCount: pipelineRunsOrError(filter: $queuedFilter) {\n      ... on Runs {\n        count\n      }\n    }\n    inProgressCount: pipelineRunsOrError(filter: $inProgressFilter) {\n      ... on Runs {\n        count\n      }\n    }\n  }\n"]);return y=function(){return e},e}let R=e=>{switch(e){case"all":return"Runs | All runs";case"failed":return"Runs | Failed";case"in-progress":return"Runs | In progress";case"queued":return"Runs | Queued";case"scheduled":return"Runs | Scheduled";default:return"Runs"}},j=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,i.a)(q,{variables:{queuedFilter:{...e,statuses:Array.from(p.sy)},inProgressFilter:{...e,statuses:Array.from(p.Ys)}}});(0,x.Hu)(n,"RunTabsCountQuery");let{data:r}=n,{queuedCount:t,inProgressCount:s}=(0,c.useMemo)(()=>{var e,n;return{queuedCount:(null==r?void 0:null===(e=r.queuedCount)||void 0===e?void 0:e.__typename)==="Runs"?r.queuedCount.count:null,inProgressCount:(null==r?void 0:null===(n=r.inProgressCount)||void 0===n?void 0:n.__typename)==="Runs"?r.inProgressCount.count:null}},[r]),[o]=(0,v.oD)(),a=b(o);(0,m.j)(R(a));let d=e=>{let n=o.filter(e=>"status"!==e.token),r=e.map(e=>({token:"status",value:e}));return(0,v.it)([...r,...n])};return{tabs:(0,u.jsxs)(l.zH,{children:[(0,u.jsx)(C,{to:d([]),id:"all",$active:"all"===a,children:"All runs"}),(0,u.jsxs)(C,{to:d(Array.from(p.sy)),id:"queued",$active:"queued"===a,children:["Queued (",null!=t?t:"indeterminate",")"]}),(0,u.jsxs)(C,{to:d(Array.from(p.Ys)),id:"in-progress",$active:"in-progress"===a,children:["In progress (",null!=s?s:"indeterminate",")"]}),(0,u.jsx)(C,{to:d(Array.from(p.hd)),id:"failed",$active:"failed"===a,children:"Failed"}),(0,u.jsx)(C,{title:"Scheduled",to:"/runs/scheduled",id:"scheduled",$active:"scheduled"===a,children:"Scheduled"})]}),queryResult:n}},C=(0,h.ZP)(g.A).withConfig({componentId:"sc-1e7c25a7-0"})(["color:",";&&:hover{color:",";}",""],o.$(),o.$(),e=>{let{$active:n}=e;return n?(0,h.iv)(["background-color:",";color:",";&&:hover{background-color:",";color:",";}"],o.AU(),o.Ep(),o.AU(),o.Ep()):(0,h.iv)(["background-color:",";"],o.v8())}),b=e=>{let{pathname:n}=(0,f.TH)();if("/runs/timeline"===n)return"timeline";if("/runs/scheduled"===n)return"scheduled";if("/overview/backfills"===n)return"backfills";let r=new Set(e.filter(e=>"status"===e.token).map(e=>e.value));return d()(p.sy,r)?"queued":d()(p.Ys,r)?"in-progress":d()(p.hd,r)?"failed":"all"},q=(0,s.Ps)(y())},6268:function(e,n,r){"use strict";r.r(n),r.d(n,{RunsRoot:function(){return B},default:function(){return M}});var t=r(52322),u=r(49853),i=r(14934),s=r(49308),l=r(74580),o=r(35292),a=r(37483),d=r(89891),c=r(80122),f=r(96795),h=r.n(f),p=r(2784),v=r(73235),m=r(24432),x=r(89130),g=r(16629),y=r(47933),R=r(9108),j=r(35232);function C(){let e=(0,v._)(['\n  query QueueDaemonStatusQuery {\n    instance {\n      id\n      daemonHealth {\n        id\n        daemonStatus(daemonType: "QUEUED_RUN_COORDINATOR") {\n          id\n          daemonType\n          healthy\n          required\n        }\n      }\n    }\n  }\n']);return C=function(){return e},e}let b=()=>{let e=(0,j._)();return(0,t.jsxs)(i.x,{flex:{direction:"column",gap:8},style:{minWidth:"100%"},border:"bottom",children:[e&&(0,t.jsx)(g.b,{intent:"info",title:(0,t.jsx)(y.rU,{to:"/config#run_coordinator",children:"View queue configuration"})}),e&&(0,t.jsx)(q,{})]})},q=()=>{let{data:e}=(0,m.a)(E),{pageTitle:n}=(0,p.useContext)(R.N),r=null==e?void 0:e.instance.daemonHealth.daemonStatus;return(null==r?void 0:r.required)&&!(null==r?void 0:r.healthy)?(0,t.jsx)(g.b,{intent:"warning",title:"The queued run coordinator is not healthy.",description:(0,t.jsxs)("div",{children:["View ",(0,t.jsx)(y.rU,{to:"/health",children:n})," for details."]})}):null},E=(0,x.Ps)(C());var _=r(38267),k=r(59351),w=r(33298),P=r(33182),A=r(52338),F=r(56675),I=r(38491),$=r(18149),T=r.n($),Q=r(96569);function O(){let e=(0,v._)(["\n  query TerminateRunIdsQuery($filter: RunsFilter!) {\n    pipelineRunsOrError(filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          status\n          canTerminate\n        }\n      }\n    }\n  }\n"]);return O=function(){return e},e}let S=e=>{let{refetch:n,filter:r,disabled:u}=e,[i,s]=(0,p.useState)(null),l=(0,F.x)(),o=async()=>{let e=await l.query({query:H,variables:{filter:r}});s("Runs"===e.data.pipelineRunsOrError.__typename?Object.fromEntries(e.data.pipelineRunsOrError.results.map(e=>[e.id,e.canTerminate])):{})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Q.A,{isOpen:null!==i,selectedRuns:i||{},selectedRunsAllQueued:T()(r,{statuses:Array.from(k.sy)}),onClose:()=>s(null),onComplete:()=>n()}),(0,t.jsx)(I.zx,{intent:"danger",outlined:!0,disabled:u,onClick:o,children:"Terminate allâ€¦"})]})},H=(0,x.Ps)(O());var N=r(74928),U=r(16336),Y=r(69737),z=r(28316);function D(e){let{node:n}=e,r=p.useRef(null);return p.useLayoutEffect(()=>{let e=r.current;if(n.parentNode!==e){if(null!==n.parentNode&&n.parentNode!==e)throw Error("Cannot render the same node twice");return null==e||e.appendChild(n),()=>{null==e||e.removeChild(n)}}},[n]),(0,t.jsx)("div",{ref:r})}var V=r(34219),L=r(59923),Z=r(85062);let B=()=>{(0,Y.Px)();let[e,n]=(0,A.oD)(),r=(0,A.VH)(e),{queryResult:f,paginationProps:v}=(0,N.E)(r);(0,V.Hu)(f,"RunsRootQuery");let m=(0,U.C4)(f,U.dT),x=(0,_.Qf)(e),g="all"!==x,[y,R]=h()(e,e=>"status"===e.token),j=(0,p.useCallback)(e=>{g?n([...y,...e]):n(e)},[n,g,y]),C=(0,p.useCallback)(e=>{let n=(0,u.HY)(e);R.some(e=>(0,u.HY)(e)===n)||j([...R,e])},[R,j]),q=(0,p.useMemo)(()=>{let e=["tag","snapshotId","id","job","pipeline","partition","backfill"];return g||e.push("status"),e},[g]),E=(0,p.useMemo)(()=>g?e.filter(e=>"status"!==e.token):e,[e,g]),{tabs:F,queryResult:I}=(0,_.zc)(r),$=(0,U.C4)(I,U.dT),T=(0,U.V5)($,m),{button:Q,activeFiltersJsx:O}=(0,A.Vv)({tokens:E,onChange:j,enabledFilters:q}),[H,B]=function(e){let[n,r]=p.useState(null);return p.useLayoutEffect(()=>{r(e=>null===e?document.createElement("div"):e)},[]),[n?(0,z.createPortal)(e,n):null,n?(0,t.jsx)(D,{node:n}):null]}(Q);function M(){var e,n,u,s;return(0,t.jsxs)(i.x,{style:{width:"100%",marginRight:8},flex:{justifyContent:"space-between"},children:[(0,t.jsxs)(i.x,{flex:{direction:"row",alignItems:"center",gap:8},children:[F,B]}),"queued"===x?(0,t.jsx)(S,{refetch:T.refetch,filter:{...r,statuses:Array.from(k.sy)},disabled:(null===(e=I.data)||void 0===e?void 0:e.queuedCount.__typename)!=="Runs"||(null===(n=I.data)||void 0===n?void 0:n.queuedCount.count)===0}):"in-progress"===x?(0,t.jsx)(S,{refetch:T.refetch,filter:{...r,statuses:Array.from(k.Ys)},disabled:(null===(u=I.data)||void 0===u?void 0:u.inProgressCount.__typename)!=="Runs"||(null===(s=I.data)||void 0===s?void 0:s.inProgressCount.count)===0}):void 0]})}return(0,t.jsxs)(s.T,{children:[(0,t.jsx)(l.m,{title:(0,t.jsx)(o.X6,{children:"Runs"}),right:(0,t.jsx)(U.xi,{refreshState:T})}),H,(0,t.jsx)(P.Lw.Provider,{value:{refetch:f.refetch},children:(0,t.jsx)(L.g,{queryResult:f,allowStaleData:!0,renderError:e=>{let n=!!((null==e?void 0:e.networkError)&&"statusCode"in e.networkError&&400===e.networkError.statusCode);return(0,t.jsxs)(i.x,{flex:{direction:"column",gap:32},padding:{vertical:8,left:24,right:12},children:[M(),(0,t.jsx)(a.t,{icon:"warning",title:n?"Invalid run filters":"Unexpected error",description:n?"The specified run filters are not valid. Please check the filters and try again.":"An unexpected error occurred. Check the console for details."})]})},children:e=>{let{pipelineRunsOrError:n}=e;return"Runs"!==n.__typename?(0,t.jsx)(i.x,{padding:{vertical:64},children:(0,t.jsx)(a.t,{icon:"error",title:"Query Error",description:n.message})}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Z.Y,{$top:0,children:(0,t.jsx)(w.A,{runs:n.results.slice(0,25),onAddTag:C,filter:r,actionBarComponents:M(),belowActionBarComponents:"queued"===x||O.length?(0,t.jsxs)(t.Fragment,{children:["queued"===x&&(0,t.jsx)(b,{}),O.length>0&&(0,t.jsxs)(t.Fragment,{children:[O,(0,t.jsx)(d.Z,{onClick:()=>j([]),children:"Clear all"})]})]}):null})}),n.results.length>0?(0,t.jsx)("div",{style:{marginTop:"16px"},children:(0,t.jsx)(c.pI,{...v})}):null]})}})})]})};var M=B},74928:function(e,n,r){"use strict";r.d(n,{E:function(){return d},z:function(){return c}});var t=r(73235),u=r(89130),i=r(30916),s=r(15332),l=r(78491),o=r(78528);function a(){let e=(0,t._)(["\n  query RunsRootQuery($limit: Int, $cursor: String, $filter: RunsFilter!) {\n    pipelineRunsOrError(limit: $limit, cursor: $cursor, filter: $filter) {\n      ... on Runs {\n        results {\n          id\n          ...RunTableRunFragment\n        }\n      }\n      ... on InvalidPipelineRunsFilterError {\n        message\n      }\n      ...PythonErrorFragment\n    }\n  }\n\n  ","\n  ","\n"]);return a=function(){return e},e}function d(e){let{queryResult:n,paginationProps:r}=(0,s.l)({nextCursorForResult:e=>{var n;if("Runs"===e.pipelineRunsOrError.__typename)return null===(n=e.pipelineRunsOrError.results[o.I-1])||void 0===n?void 0:n.id},getResultArray:e=>e&&"Runs"===e.pipelineRunsOrError.__typename?e.pipelineRunsOrError.results:[],variables:{filter:e},query:c,pageSize:o.I});return{queryResult:n,paginationProps:r}}let c=(0,u.Ps)(a(),i.Z,l.B)},85062:function(e,n,r){"use strict";r.d(n,{Y:function(){return u}});var t=r(39013);let u=r(35505).ZP.div.withConfig({componentId:"sc-1e417a12-0"})(["thead tr{position:sticky;top:","px;background-color:",";z-index:1;}thead tr th{position:relative;}thead tr th::after{content:'';display:block;height:1px;background-color:",";position:absolute;bottom:-1px;left:0;right:0;}"],e=>{let{$top:n=0}=e;return n},t.v8(),t.wL())}}]);
//# sourceMappingURL=6268.ce1ea8dfe972251c.js.map