"use strict";(self["webpackChunk_jupyterlab_application_top"]=self["webpackChunk_jupyterlab_application_top"]||[]).push([[9605],{39605:(e,t,i)=>{i.r(t);i.d(t,{EditorView:()=>o.EditorView,basicSetup:()=>te,minimalSetup:()=>ie});var o=i(22819);var n=i(71674);var s=i(4452);var r=i(18426);var l=i(9059);var a=i(75128);var c=i(41107);class d{constructor(e,t,i){this.from=e;this.to=t;this.diagnostic=i}}class f{constructor(e,t,i){this.diagnostics=e;this.panel=t;this.selected=i}static init(e,t,i){let n=e;let s=i.facet(L).markerFilter;if(s)n=s(n,i);let r=o.Decoration.set(n.map((e=>e.from==e.to||e.from==e.to-1&&i.doc.lineAt(e.from).to==e.from?o.Decoration.widget({widget:new F(e),diagnostic:e}).range(e.from):o.Decoration.mark({attributes:{class:"cm-lintRange cm-lintRange-"+e.severity+(e.markClass?" "+e.markClass:"")},diagnostic:e}).range(e.from,e.to))),true);return new f(r,t,u(r))}}function u(e,t=null,i=0){let o=null;e.between(i,1e9,((e,i,{spec:n})=>{if(t&&n.diagnostic!=t)return;o=new d(e,i,n.diagnostic);return false}));return o}function h(e,t){let i=t.pos,o=t.end||i;let n=e.state.facet(L).hideOn(e,i,o);if(n!=null)return n;let s=e.startState.doc.lineAt(t.pos);return!!(e.effects.some((e=>e.is(p)))||e.changes.touchesRange(s.from,Math.max(s.to,o)))}function m(e,t){return e.field(b,false)?t:t.concat(n.StateEffect.appendConfig.of(W))}function g(e,t){return{effects:m(e,[p.of(t)])}}const p=n.StateEffect.define();const v=n.StateEffect.define();const w=n.StateEffect.define();const b=n.StateField.define({create(){return new f(o.Decoration.none,null,null)},update(e,t){if(t.docChanged&&e.diagnostics.size){let i=e.diagnostics.map(t.changes),o=null,n=e.panel;if(e.selected){let n=t.changes.mapPos(e.selected.from,1);o=u(i,e.selected.diagnostic,n)||u(i,null,n)}if(!i.size&&n&&t.state.facet(L).autoPanel)n=null;e=new f(i,n,o)}for(let i of t.effects){if(i.is(p)){let o=!t.state.facet(L).autoPanel?e.panel:i.value.length?j.open:null;e=f.init(i.value,o,t.state)}else if(i.is(v)){e=new f(e.diagnostics,i.value?j.open:null,e.selected)}else if(i.is(w)){e=new f(e.diagnostics,e.panel,i.value)}}return e},provide:e=>[o.showPanel.from(e,(e=>e.panel)),o.EditorView.decorations.from(e,(e=>e.diagnostics))]});function y(e){let t=e.field(b,false);return t?t.diagnostics.size:0}const k=o.Decoration.mark({class:"cm-lintRange cm-lintRange-active"});function x(e,t,i){let{diagnostics:o}=e.state.field(b);let n=[],s=2e8,r=0;o.between(t-(i<0?1:0),t+(i>0?1:0),((e,o,{spec:l})=>{if(t>=e&&t<=o&&(e==o||(t>e||i>0)&&(t<o||i<0))){n.push(l.diagnostic);s=Math.min(e,s);r=Math.max(o,r)}}));let l=e.state.facet(L).tooltipFilter;if(l)n=l(n,e.state);if(!n.length)return null;return{pos:s,end:r,above:e.state.doc.lineAt(s).to<r,create(){return{dom:C(e,n)}}}}function C(e,t){return(0,c.A)("ul",{class:"cm-tooltip-lint"},t.map((t=>O(e,t,false))))}const S=e=>{let t=e.state.field(b,false);if(!t||!t.panel)e.dispatch({effects:m(e.state,[v.of(true)])});let i=(0,o.getPanel)(e,j.open);if(i)i.dom.querySelector(".cm-panel-lint ul").focus();return true};const A=e=>{let t=e.state.field(b,false);if(!t||!t.panel)return false;e.dispatch({effects:v.of(false)});return true};const T=e=>{let t=e.state.field(b,false);if(!t)return false;let i=e.state.selection.main,o=t.diagnostics.iter(i.to+1);if(!o.value){o=t.diagnostics.iter(0);if(!o.value||o.from==i.from&&o.to==i.to)return false}e.dispatch({selection:{anchor:o.from,head:o.to},scrollIntoView:true});return true};const R=e=>{let{state:t}=e,i=t.field(b,false);if(!i)return false;let o=t.selection.main;let n,s,r,l;i.diagnostics.between(0,t.doc.length,((e,t)=>{if(t<o.to&&(n==null||n<e)){n=e;s=t}if(r==null||e>r){r=e;l=t}}));if(r==null||n==null&&r==o.from)return false;e.dispatch({selection:{anchor:n!==null&&n!==void 0?n:r,head:s!==null&&s!==void 0?s:l},scrollIntoView:true});return true};const D=[{key:"Mod-Shift-m",run:S,preventDefault:true},{key:"F8",run:T}];const E=null&&ViewPlugin.fromClass(class{constructor(e){this.view=e;this.timeout=-1;this.set=true;let{delay:t}=e.state.facet(L);this.lintTime=Date.now()+t;this.run=this.run.bind(this);this.timeout=setTimeout(this.run,t)}run(){clearTimeout(this.timeout);let e=Date.now();if(e<this.lintTime-10){this.timeout=setTimeout(this.run,this.lintTime-e)}else{this.set=false;let{state:e}=this.view,{sources:t}=e.facet(L);if(t.length)Promise.all(t.map((e=>Promise.resolve(e(this.view))))).then((t=>{let i=t.reduce(((e,t)=>e.concat(t)));if(this.view.state.doc==e.doc)this.view.dispatch(g(this.view.state,i))}),(e=>{logException(this.view.state,e)}))}}update(e){let t=e.state.facet(L);if(e.docChanged||t!=e.startState.facet(L)||t.needsRefresh&&t.needsRefresh(e)){this.lintTime=Date.now()+t.delay;if(!this.set){this.set=true;this.timeout=setTimeout(this.run,t.delay)}}}force(){if(this.set){this.lintTime=Date.now();this.run()}}destroy(){clearTimeout(this.timeout)}});const L=n.Facet.define({combine(e){return Object.assign({sources:e.map((e=>e.source)).filter((e=>e!=null))},(0,n.combineConfig)(e.map((e=>e.config)),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null,hideOn:()=>null},{needsRefresh:(e,t)=>!e?t:!t?e:i=>e(i)||t(i)}))}});function P(e,t={}){return[L.of({source:e,config:t}),E,W]}function I(e){let t=e.plugin(E);if(t)t.force()}function M(e){let t=[];if(e)e:for(let{name:i}of e){for(let e=0;e<i.length;e++){let o=i[e];if(/[a-zA-Z]/.test(o)&&!t.some((e=>e.toLowerCase()==o.toLowerCase()))){t.push(o);continue e}}t.push("")}return t}function O(e,t,i){var o;let n=i?M(t.actions):[];return(0,c.A)("li",{class:"cm-diagnostic cm-diagnostic-"+t.severity},(0,c.A)("span",{class:"cm-diagnosticText"},t.renderMessage?t.renderMessage(e):t.message),(o=t.actions)===null||o===void 0?void 0:o.map(((i,o)=>{let s=false,r=o=>{o.preventDefault();if(s)return;s=true;let n=u(e.state.field(b).diagnostics,t);if(n)i.apply(e,n.from,n.to)};let{name:l}=i,a=n[o]?l.indexOf(n[o]):-1;let d=a<0?l:[l.slice(0,a),(0,c.A)("u",l.slice(a,a+1)),l.slice(a+1)];return(0,c.A)("button",{type:"button",class:"cm-diagnosticAction",onclick:r,onmousedown:r,"aria-label":` Action: ${l}${a<0?"":` (access key "${n[o]})"`}.`},d)})),t.source&&(0,c.A)("div",{class:"cm-diagnosticSource"},t.source))}class F extends o.WidgetType{constructor(e){super();this.diagnostic=e}eq(e){return e.diagnostic==this.diagnostic}toDOM(){return(0,c.A)("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class B{constructor(e,t){this.diagnostic=t;this.id="item_"+Math.floor(Math.random()*4294967295).toString(16);this.dom=O(e,t,true);this.dom.id=this.id;this.dom.setAttribute("role","option")}}class j{constructor(e){this.view=e;this.items=[];let t=t=>{if(t.keyCode==27){A(this.view);this.view.focus()}else if(t.keyCode==38||t.keyCode==33){this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length)}else if(t.keyCode==40||t.keyCode==34){this.moveSelection((this.selectedIndex+1)%this.items.length)}else if(t.keyCode==36){this.moveSelection(0)}else if(t.keyCode==35){this.moveSelection(this.items.length-1)}else if(t.keyCode==13){this.view.focus()}else if(t.keyCode>=65&&t.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:i}=this.items[this.selectedIndex],o=M(i.actions);for(let n=0;n<o.length;n++)if(o[n].toUpperCase().charCodeAt(0)==t.keyCode){let t=u(this.view.state.field(b).diagnostics,i);if(t)i.actions[n].apply(e,t.from,t.to)}}else{return}t.preventDefault()};let i=e=>{for(let t=0;t<this.items.length;t++){if(this.items[t].dom.contains(e.target))this.moveSelection(t)}};this.list=(0,c.A)("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:t,onclick:i});this.dom=(0,c.A)("div",{class:"cm-panel-lint"},this.list,(0,c.A)("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>A(this.view)},"Ã—"));this.update()}get selectedIndex(){let e=this.view.state.field(b).selected;if(!e)return-1;for(let t=0;t<this.items.length;t++)if(this.items[t].diagnostic==e.diagnostic)return t;return-1}update(){let{diagnostics:e,selected:t}=this.view.state.field(b);let i=0,o=false,n=null;e.between(0,this.view.state.doc.length,((e,s,{spec:r})=>{let l=-1,a;for(let t=i;t<this.items.length;t++)if(this.items[t].diagnostic==r.diagnostic){l=t;break}if(l<0){a=new B(this.view,r.diagnostic);this.items.splice(i,0,a);o=true}else{a=this.items[l];if(l>i){this.items.splice(i,l-i);o=true}}if(t&&a.diagnostic==t.diagnostic){if(!a.dom.hasAttribute("aria-selected")){a.dom.setAttribute("aria-selected","true");n=a}}else if(a.dom.hasAttribute("aria-selected")){a.dom.removeAttribute("aria-selected")}i++}));while(i<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0)){o=true;this.items.pop()}if(this.items.length==0){this.items.push(new B(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")}));o=true}if(n){this.list.setAttribute("aria-activedescendant",n.id);this.view.requestMeasure({key:this,read:()=>({sel:n.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:e,panel:t})=>{let i=t.height/this.list.offsetHeight;if(e.top<t.top)this.list.scrollTop-=(t.top-e.top)/i;else if(e.bottom>t.bottom)this.list.scrollTop+=(e.bottom-t.bottom)/i}})}else if(this.selectedIndex<0){this.list.removeAttribute("aria-activedescendant")}if(o)this.sync()}sync(){let e=this.list.firstChild;function t(){let t=e;e=t.nextSibling;t.remove()}for(let i of this.items){if(i.dom.parentNode==this.list){while(e!=i.dom)t();e=i.dom.nextSibling}else{this.list.insertBefore(i.dom,e)}}while(e)t()}moveSelection(e){if(this.selectedIndex<0)return;let t=this.view.state.field(b);let i=u(t.diagnostics,this.items[e].diagnostic);if(!i)return;this.view.dispatch({selection:{anchor:i.from,head:i.to},scrollIntoView:true,effects:w.of(i)})}static open(e){return new j(e)}}function V(e,t=`viewBox="0 0 40 40"`){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${t}>${encodeURIComponent(e)}</svg>')`}function H(e){return V(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${e}" fill="none" stroke-width=".7"/>`,`width="6" height="3"`)}const _=o.EditorView.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:H("#d11")},".cm-lintRange-warning":{backgroundImage:H("orange")},".cm-lintRange-info":{backgroundImage:H("#999")},".cm-lintRange-hint":{backgroundImage:H("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function z(e){return e=="error"?4:e=="warning"?3:e=="info"?2:1}class K extends o.GutterMarker{constructor(e){super();this.diagnostics=e;this.severity=e.reduce(((e,t)=>z(e)<z(t.severity)?t.severity:e),"hint")}toDOM(e){let t=document.createElement("div");t.className="cm-lint-marker cm-lint-marker-"+this.severity;let i=this.diagnostics;let o=e.state.facet(J).tooltipFilter;if(o)i=o(i,e.state);if(i.length)t.onmouseover=()=>$(e,t,i);return t}}function N(e,t){let i=o=>{let n=t.getBoundingClientRect();if(o.clientX>n.left-10&&o.clientX<n.right+10&&o.clientY>n.top-10&&o.clientY<n.bottom+10)return;for(let e=o.target;e;e=e.parentNode){if(e.nodeType==1&&e.classList.contains("cm-tooltip-lint"))return}window.removeEventListener("mousemove",i);if(e.state.field(Z))e.dispatch({effects:Y.of(null)})};window.addEventListener("mousemove",i)}function $(e,t,i){function o(){let o=e.elementAtHeight(t.getBoundingClientRect().top+5-e.documentTop);const n=e.coordsAtPos(o.from);if(n){e.dispatch({effects:Y.of({pos:o.from,above:false,create(){return{dom:C(e,i),getCoords:()=>t.getBoundingClientRect()}}})})}t.onmouseout=t.onmousemove=null;N(e,t)}let{hoverTime:n}=e.state.facet(J);let s=setTimeout(o,n);t.onmouseout=()=>{clearTimeout(s);t.onmouseout=t.onmousemove=null};t.onmousemove=()=>{clearTimeout(s);s=setTimeout(o,n)}}function U(e,t){let i=Object.create(null);for(let n of t){let t=e.lineAt(n.from);(i[t.from]||(i[t.from]=[])).push(n)}let o=[];for(let n in i){o.push(new K(i[n]).range(+n))}return n.RangeSet.of(o,true)}const q=(0,o.gutter)({class:"cm-gutter-lint",markers:e=>e.state.field(G)});const G=n.StateField.define({create(){return n.RangeSet.empty},update(e,t){e=e.map(t.changes);let i=t.state.facet(J).markerFilter;for(let o of t.effects){if(o.is(p)){let n=o.value;if(i)n=i(n||[],t.state);e=U(t.state.doc,n.slice(0))}}return e}});const Y=n.StateEffect.define();const Z=n.StateField.define({create(){return null},update(e,t){if(e&&t.docChanged)e=h(t,e)?null:Object.assign(Object.assign({},e),{pos:t.changes.mapPos(e.pos)});return t.effects.reduce(((e,t)=>t.is(Y)?t.value:e),e)},provide:e=>o.showTooltip.from(e)});const X=o.EditorView.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:V(`<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>`)},".cm-lint-marker-warning":{content:V(`<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>`)},".cm-lint-marker-error":{content:V(`<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>`)}});const W=[b,o.EditorView.decorations.compute([b],(e=>{let{selected:t,panel:i}=e.field(b);return!t||!i||t.from==t.to?o.Decoration.none:o.Decoration.set([k.range(t.from,t.to)])})),(0,o.hoverTooltip)(x,{hideOn:h}),_];const J=n.Facet.define({combine(e){return(0,n.combineConfig)(e,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function Q(e={}){return[J.of(e),G,q,X,Z]}function ee(e,t){let i=e.field(b,false);if(i&&i.diagnostics.size)for(let o=RangeSet.iter([i.diagnostics]);o.value;o.next())t(o.value.spec.diagnostic,o.from,o.to)}const te=(()=>[(0,o.lineNumbers)(),(0,o.highlightActiveLineGutter)(),(0,o.highlightSpecialChars)(),(0,r.history)(),(0,s.foldGutter)(),(0,o.drawSelection)(),(0,o.dropCursor)(),n.EditorState.allowMultipleSelections.of(true),(0,s.indentOnInput)(),(0,s.syntaxHighlighting)(s.defaultHighlightStyle,{fallback:true}),(0,s.bracketMatching)(),(0,a.wm)(),(0,a.yU)(),(0,o.rectangularSelection)(),(0,o.crosshairCursor)(),(0,o.highlightActiveLine)(),(0,l.highlightSelectionMatches)(),o.keymap.of([...a.Bc,...r.defaultKeymap,...l.searchKeymap,...r.historyKeymap,...s.foldKeymap,...a.OO,...D])])();const ie=(()=>[(0,o.highlightSpecialChars)(),(0,r.history)(),(0,o.drawSelection)(),(0,s.syntaxHighlighting)(s.defaultHighlightStyle,{fallback:true}),o.keymap.of([...r.defaultKeymap,...r.historyKeymap])])()},41107:(e,t,i)=>{i.d(t,{A:()=>o});function o(){var e=arguments[0];if(typeof e=="string")e=document.createElement(e);var t=1,i=arguments[1];if(i&&typeof i=="object"&&i.nodeType==null&&!Array.isArray(i)){for(var o in i)if(Object.prototype.hasOwnProperty.call(i,o)){var s=i[o];if(typeof s=="string")e.setAttribute(o,s);else if(s!=null)e[o]=s}t++}for(;t<arguments.length;t++)n(e,arguments[t]);return e}function n(e,t){if(typeof t=="string"){e.appendChild(document.createTextNode(t))}else if(t==null){}else if(t.nodeType!=null){e.appendChild(t)}else if(Array.isArray(t)){for(var i=0;i<t.length;i++)n(e,t[i])}else{throw new RangeError("Unsupported child node: "+t)}}}}]);