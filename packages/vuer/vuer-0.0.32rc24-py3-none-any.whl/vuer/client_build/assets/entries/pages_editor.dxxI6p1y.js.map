{"version":3,"file":"pages_editor.dxxI6p1y.js","sources":["../../../../pages/editor/+Page.tsx"],"sourcesContent":["import React, { useEffect, useMemo } from 'react';\nimport { Helmet } from '@vuer-ai/react-helmet-async';\nimport './index.scss';\nimport {\n  AmbientLight,\n  Grid,\n  Hands,\n  PlaybackBar,\n  PlaybackProvider,\n  PointLight,\n  ResizableSwitch,\n  WebSocketProvider,\n  Timeline,\n  SceneContainer,\n  useSocket,\n  Combine,\n  PlaybackStateProvider,\n  usePlayback,\n  TimelineStateProvider,\n  Resizable,\n  GraphView, useSceneStore,\n} from '@vuer-ai/vuer';\nimport { Leva } from 'leva';\n\nfunction VuerPlayback() {\n  const playback = usePlayback();\n  const { downlink } = useSocket();\n\n  useEffect(() => {\n    if (!playback) return;\n    const cancel = [\n      downlink.subscribe('SET', playback.addKeyFrame),\n      downlink.subscribe('ADD', playback.addKeyFrame),\n      downlink.subscribe('UPDATE', playback.addKeyFrame),\n      downlink.subscribe('UPSERT', playback.addKeyFrame),\n      downlink.subscribe('REMOVE', playback.addKeyFrame),\n    ];\n\n    return () => {\n      cancel.forEach((f) => f());\n    };\n  }, [playback, downlink]);\n\n\n  const combinedStream = useMemo(\n    () => {\n      if (!playback?.store) return downlink;\n      return new Combine(downlink, playback.store);\n    },\n    [downlink, playback?.store],\n  );\n\n  if (!playback) {\n    return (\n      <SceneContainer\n        frameloop=\"always\"\n        stream={downlink}\n        bgChildren={[\n          <Grid key=\"default-grid\" _key=\"default-grid\" />,\n        ]}\n      >\n        <AmbientLight key=\"ambient\" intensity={0.25} />\n        <PointLight key=\"spot\" intensity={1} position={[0, 1, 1]} />\n        <Hands fps={30} eventType={['squeeze']} stream />\n      </SceneContainer>\n    );\n  } else return (\n    <ResizableSwitch\n      offset={200}\n      minOffset={48}\n      hidden={true}\n      style={{\n        width: '100%',\n        height: '100%',\n      }}\n    >\n      <SceneContainer\n        frameloop=\"always\"\n        stream={combinedStream}\n        bgChildren={[\n          <Grid key=\"default-grid\" _key=\"default-grid\" />,\n        ]}\n      >\n        <AmbientLight key=\"ambient\" intensity={0.25} />\n        <PointLight key=\"spot\" intensity={1} position={[0, 1, 1]} />\n        <Hands fps={30} eventType={['squeeze']} stream />\n      </SceneContainer>\n      <>\n        <PlaybackStateProvider>\n          <TimelineStateProvider>\n            <PlaybackBar />\n            <Timeline />\n          </TimelineStateProvider>\n        </PlaybackStateProvider>\n      </>\n      <PlaybackStateProvider>\n        <TimelineStateProvider>\n          <PlaybackBar />\n        </TimelineStateProvider>\n      </PlaybackStateProvider>\n    </ResizableSwitch>\n  );\n}\n\nfunction SidePanelView() {\n  // this is excessive. triggers when position/rotation changes too.\n  // const scene = useSceneStore(({ children, bgChildren, rawChildren }) =>\n  //   ({ children, bgChildren, rawChildren }));\n  const children = useSceneStore(({ children }) => children);\n  const sceneOps = useSceneStore(({ ops }) => ops);\n  // return <VuerPlayback />;\n\n  return (\n    <Resizable vertical offset={-200} hidden={true}>\n      <VuerPlayback />\n      <GraphView\n        title=\"Scene Graph\"\n        nodes={children}\n        sceneOps={sceneOps}\n      />\n    </Resizable>\n  );\n}\n\nexport default function Page() {\n  const isSSR = typeof window === 'undefined';\n\n  return (\n    <>\n      <Helmet>\n        <title>Vuer | Stereo Video and WebRTC Demo</title>\n      </Helmet>\n      <main>\n        <PlaybackProvider>\n          {\n            isSSR ? null : (\n              <WebSocketProvider>\n                {/*<VuerPlayback />*/}\n                <SidePanelView />\n              </WebSocketProvider>\n            )\n          }\n        </PlaybackProvider>\n        <Leva\n          theme={{\n            sizes: {\n              rootWidth: '380px',\n              controlWidth: '200px',\n              numberInputMinWidth: '56px',\n            },\n          }}\n        />\n      </main>\n    </>\n  );\n}"],"names":["VuerPlayback","playback","usePlayback","downlink","useSocket","useEffect","cancel","f","combinedStream","useMemo","Combine","jsxs","ResizableSwitch","SceneContainer","jsx","Grid","AmbientLight","PointLight","Hands","Fragment","PlaybackStateProvider","TimelineStateProvider","PlaybackBar","Timeline","SidePanelView","children","useSceneStore","sceneOps","ops","Resizable","GraphView","Page","isSSR","Helmet","PlaybackProvider","WebSocketProvider","Leva"],"mappings":"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"}